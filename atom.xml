<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>clock</title>
  
  
  <link href="https://ljweb.xyz/atom.xml" rel="self"/>
  
  <link href="https://ljweb.xyz/"/>
  <updated>2022-02-16T14:10:43.384Z</updated>
  <id>https://ljweb.xyz/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>51å•ç‰‡æœºçš„å»¶æ—¶å‡½æ•°</title>
    <link href="https://ljweb.xyz/2022/01/10/51%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E5%BB%B6%E6%97%B6%E5%87%BD%E6%95%B0/"/>
    <id>https://ljweb.xyz/2022/01/10/51%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E5%BB%B6%E6%97%B6%E5%87%BD%E6%95%B0/</id>
    <published>2022-01-10T04:20:30.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_43858743/article/details/86178280"> 51å•ç‰‡æœºçš„å»¶æ—¶è®¡ç®—_æµ·è‰æµ·è‰çš„åšå®¢-CSDNåšå®¢_å•ç‰‡æœºdelayå»¶æ—¶æ—¶é—´æ€ä¹ˆç®—</a></p></blockquote><h1 id="æ–¹æ³•ï¼š"><a href="#æ–¹æ³•ï¼š" class="headerlink" title="æ–¹æ³•ï¼š"></a>æ–¹æ³•ï¼š</h1><p>1.ä½¿ç”¨STC-ISPè½¯ä»¶ä¸­çš„è½¯ä»¶å»¶æ—¶è®¡ç®—å™¨(åªèƒ½ç”Ÿæˆå›ºå®šæ—¶é—´çš„å‡½æ•°)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/weixin_43858743/article/details/86178280&quot;&gt; 51å•ç‰‡æœºçš„å»¶æ—¶è®¡ç®—_æµ·è‰æµ·è‰çš„åšå®¢-CSDNåšå®¢_å•ç‰‡æœºdelayå»¶æ—¶æ—¶é—´æ€ä¹ˆç®—&lt;/a&gt;&lt;/</summary>
      
    
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://ljweb.xyz/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="51å•ç‰‡æœº" scheme="https://ljweb.xyz/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>2021ç”µèµ›æ€»ç»“</title>
    <link href="https://ljweb.xyz/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/"/>
    <id>https://ljweb.xyz/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/</id>
    <published>2021-12-13T15:10:08.000Z</published>
    <updated>2022-02-16T14:10:43.372Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æŒ«æŠ˜ä¹‹åçš„æˆé•¿"><a href="#æŒ«æŠ˜ä¹‹åçš„æˆé•¿" class="headerlink" title="æŒ«æŠ˜ä¹‹åçš„æˆé•¿"></a>æŒ«æŠ˜ä¹‹åçš„æˆé•¿</h2><p>&emsp;&emsp;2021å¹´çš„ç”µèµ›è¿‡å»è¿‘ä¸¤ä¸ªæœˆäº†ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ ç”µèµ›ï¼Œè™½ç„¶æœ€åæ²¡èƒ½å®Œèµ›ï¼ˆæˆ‘å¤ªèœå•¦ï¼ï¼‰ä½†æ˜¯ç»è¿‡è¿™æ¬¡çš„ç”µèµ›çš„ç»å†ä¹Ÿè®©æˆ‘è®¤è¯†åˆ°äº†å’Œå¤§ä½¬çš„å·®è·å’Œè‡ªèº«çš„ä¸è¶³ã€‚ä¹Ÿè®©æˆ‘å½»åº•çˆ±ä¸Šäº†è¿™ç§å­¦ä¹ ã€è®¾è®¡ï¼Œåˆ¶ä½œã€å¤´è„‘é£æš´çš„æ„Ÿè§‰ã€‚å¸Œæœ›è‡ªå·±èƒ½è®°ä½è¿™æ¬¡çš„å¤±åˆ©ï¼Œè®°ä½è¿™è½å·®ã€‚ä¸ä¼šè¢«ä¸€æ—¶çš„æŒ«æŠ˜è€ŒæŠ¹æ€ä¸“æ³¨å’Œçƒ­çˆ±ï¼Œä»¥åå¥½å¥½ç©ä¸”ç©å¥½ï¼</p><h2 id="èµ›é¢˜åˆ†æ"><a href="#èµ›é¢˜åˆ†æ" class="headerlink" title="èµ›é¢˜åˆ†æ"></a>èµ›é¢˜åˆ†æ</h2><p>&emsp;&emsp;æˆ‘ä»¬ç»„é€‰æ‹©çš„æ˜¯Fé¢˜ï¼š<a href="https://ljweb.xyz/files/%E6%99%BA%E8%83%BD%E9%80%81%E8%8D%AF%E5%B0%8F%E8%BD%A6%EF%BC%88F%E9%A2%98%EF%BC%89.pdf">åšä¸€ä¸ªé€è¯å°è½¦</a>ï¼ŒåŸºç¡€é¢˜ä¸€å…±æœ‰ä¸‰ä¸ªä»»åŠ¡ï¼ˆå› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å‚åŠ ç”µèµ›æˆ‘ä»¬å°±å¥”ç€åŸºç¡€é¢˜å»äº†ï¼‰ï¼Œå°è½¦å…ˆè¦åœ¨èµ·ç‚¹è¯†åˆ«å‡ºç»™å®šçš„æ•°å­—ï¼ˆæ•°å­—æ‰“å°åœ¨çº¸ä¸Šï¼‰ï¼Œå–åˆ°è¯å“åå¾ªè¿¹å»æ•°å­—å¯¹åº”çš„è¯æˆ¿ï¼Œç„¶åç­‰å¾…è¯å“å¸è´§ï¼Œæœ€åè‡ªä¸»è¿”å›èµ·ç‚¹ã€‚</p><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/1.3.png" alt="tm"></p><p>&emsp;&emsp;4å·æ—©ä¸Šé¢˜ç›®å‡ºæ¥åï¼Œæˆ‘å’Œé˜Ÿå‘˜ä»¬ä¸€æ—¶éƒ½å‚»äº†çœ¼ï¼å› ä¸ºæˆ‘ä»¬éƒ½æ˜¯å¤§äºŒçš„åŒå­¦ï¼Œå¦‚æœæ­¤æ¬¡ç”µèµ›ä¸æ¨è¿Ÿåˆ°11æœˆçš„è¯ï¼Œæˆ‘ä»¬é˜Ÿä¼ç”šè‡³æ‰å¤§ä¸€ï¼Œæˆ‘ä»¬è°éƒ½æ²¡æœ‰åšè¿™ä¹ˆéš¾é¡¹ç›®çš„ç»éªŒã€‚å®ä¸ç›¸ç’ï¼Œä»¥æˆ‘ä»¬å›¢é˜Ÿç›®å‰çš„æ°´å¹³åªèƒ½å†™ä¸ª51å•ç‰‡æœºï¼Œå½“æ—¶äº”æœˆä»½æŠ¥åå‚åŠ ç”µèµ›çš„æ—¶å€™ä¹Ÿæ˜¯æŠ±ç€è§ä¸–é¢å»è¯•ä¸€è¯•çš„ï¼Œè€Œå‚åŠ è¿™æ¬¡æ¯”èµ›çš„å­¦é•¿ä»¬ï¼Œä¹Ÿéƒ½æ”¾å¼ƒäº†ä»¥å¾€ç›¸å¯¹ç®€å•çš„ä½†ä»Šå¹´éš¾åº¦ä¸Šå¤©çš„å°è½¦é¢˜ï¼ˆå½“ç„¶å…¶ä»–ç»„çš„é¢˜ç›®ä¹Ÿä¸å¥½åšï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬é¢å¯¹çš„æƒ…å†µå°±æ˜¯ï¼Œå…¨æ ¡å°±ä¸¤ç»„åœ¨åšå°è½¦é¢˜ï¼ˆå¦ä¸€ç»„ä¹Ÿæ˜¯å’Œæˆ‘ä»¬ä¸€æ ·ï¼Œå¤§äºŒï¼Œæ²¡æœ‰ç›¸å…³ç»éªŒï¼‰ã€‚</p><h2 id="ç”µèµ›Fé¢˜çš„éš¾ç‚¹ï¼š"><a href="#ç”µèµ›Fé¢˜çš„éš¾ç‚¹ï¼š" class="headerlink" title="ç”µèµ›Fé¢˜çš„éš¾ç‚¹ï¼š"></a>ç”µèµ›Fé¢˜çš„éš¾ç‚¹ï¼š</h2><h5 id="1-å¾ªè¿¹ï¼š"><a href="#1-å¾ªè¿¹ï¼š" class="headerlink" title="1.å¾ªè¿¹ï¼š"></a>1.å¾ªè¿¹ï¼š</h5><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/1.png" alt="åŒ»é™¢åœ°å›¾"></p><p>&emsp;&emsp;æˆ‘åšè¿‡ä¸€ä¸ªç”¨çº¢å¤–æ¥å¾ªè¿¹çš„51å°è½¦ï¼Œä½†æ˜¯é¢˜ç›®ä¸ºäº†å¢å¤§éš¾åº¦ï¼Œå¦‚å›¾ï¼Œè½¨é“ä¸­é—´çš„çº¿æ˜¯çº¢è‰²çš„ï¼ˆå› ä¸ºçº¢è‰²å’Œèµ›é“èƒŒæ™¯çš„ç™½è‰²åå·®ä¸åƒé»‘è‰²å’Œç™½è‰²é‚£æ ·å¤§ğŸ˜­ï¼‰ï¼Œæ‰€ä»¥ç”¨ä¸äº†çº¢å¤–çš„æ–¹æ¡ˆã€‚è¿™ä¸‹æˆ‘ä»¬æƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨OpenMvè¿›è¡Œè§†è§‰å¾ªè¿¹ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ç”¨ç°åº¦ä¼ æ„Ÿå™¨ï¼ï¼‰ï¼Œå¯æ˜¯æˆ‘ä»¬ä»æ¥æ²¡æ¥è§¦è¿‡OpenMvï¼Œåªèƒ½ç°å­¦ç°åšï¼Œè¿˜å¥½æˆ‘ä»ä¸€ä¸ªåšæ— äººæœºç»„çš„å­¦é•¿é‚£é‡Œå€Ÿæ¥äº†ä¸€ä¸ªOpenMvï¼Œè¿™è®©æˆ‘èƒ½é¢˜ç›®ç¡®å®šä¹‹åç«‹é©¬å¼€å§‹å­¦ä¹ OpenMvã€‚ç„¶åè€å¸ˆä¹Ÿå¸®æˆ‘ä»¬ä¹°äº†æ–°çš„OpenMvæ¨¡å—ï¼Œè§£å†³äº†ç‡ƒçœ‰ä¹‹æ€¥ã€‚</p><p>&emsp;&emsp;åœ¨æˆ‘å¼€å§‹å­¦ä¹ OpenMvçš„æ—¶å€™ï¼Œå¦å¤–ä¸€åé˜Ÿå‹åœ¨åšå°è½¦çš„ç¡¬ä»¶éƒ¨åˆ†ï¼Œå› ä¸ºå®éªŒå®¤æœ‰å¾ˆå¤šå››é©±å°è½¦çš„è½¦æ¨¡ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åå°±é‡‡ç”¨äº†ã€‚</p><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/2.1.png" alt="ç¬¬ä¸€ç‰ˆè½¦æ¨¡"></p><p>&emsp;&emsp;æˆ‘ä»¬ç”¨çš„æ˜¯Arduino unoå½“ä¸‹ä½æœºï¼ŒåŸå› æ˜¯arduinoæ¯”è¾ƒç®€å•ï¼Œç¨‹åºå¾ˆå¥½å†™ï¼Œæˆ‘å½“æ—¶çš„æƒ³æ³•æ˜¯ä¿¡æ¯å¤„ç†å’Œç”µæœºåŠ¨ä½œæ§åˆ¶éƒ½åœ¨OpenMvä¸Šåšï¼Œarduinoåªç”¨æ¥è¿›è¡Œç®€å•çš„æ”¶åˆ°ä¸²å£é€šè®¯æŒ‡ä»¤åæ§åˆ¶ç”µæœºå’Œä¸¤ä¸ªLEDç¯ã€‚</p><p>&emsp;&emsp;çº¢çº¿å¾ªè¿¹çš„éƒ¨åˆ†æˆ‘ç¬¬äºŒå¤©å®ç°äº†ï¼Œä¹Ÿèƒ½è¯†åˆ«å‡ºåå­—è·¯å£ï¼Œç„¶ååœä¸‹ã€‚</p><h5 id="2-æ•°å­—è¯†åˆ«ï¼š"><a href="#2-æ•°å­—è¯†åˆ«ï¼š" class="headerlink" title="2.æ•°å­—è¯†åˆ«ï¼š"></a>2.æ•°å­—è¯†åˆ«ï¼š</h5><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/1.1.png" alt="å­—æ¨¡"></p><p>&emsp;&emsp;æ•°å­—è¯†åˆ«æˆ‘ä¹Ÿç”¨çš„æ˜¯OpenMvçš„æ¨¡æ¿åŒ¹é…ï¼Œè¯†åˆ«æ•ˆæœè¿˜è¡Œï¼Œå°±æ˜¯å¯¹å°è½¦çš„è§’åº¦å’Œè·ç¦»éƒ½æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯æ²¡åŠæ³•ï¼Œæ¯”èµ›å·²ç»åˆ°ç¬¬äºŒå¤©äº†ï¼Œå†ä¹°å…ƒä»¶å·²ç»æ¥ä¸åŠäº†ï¼Œåªèƒ½ç¡¬ç€å¤´çš®åšä¸‹å»ã€‚</p><p>&emsp;&emsp;æ•°å­—è¯†åˆ«åœ¨ç¬¬ä¸‰å¤©çš„æœ€åä¹Ÿåšå¾—å·®ä¸å¤šäº†ï¼Œåˆ°è¿™é‡Œï¼Œå°è½¦å·²ç»èƒ½ä»èµ·ç‚¹å‡ºå‘ï¼Œå¾ªè¿¹æ‰¾åˆ°åå­—è·¯å£åï¼Œåœä¸‹æ¥è¿›è¡Œè¯†åˆ«äº†ï¼Œæˆ–è€…è¿›è¡Œè½¬å¼¯ã€‚ä¸¤å¤©å†…ä»0å¼€å§‹å­¦ä¹ åˆ°èƒ½è¯†åˆ«åˆ°æ•°å­—è¿˜æ˜¯å¾ˆæ¿€åŠ¨çš„ï¼Œè¿™å¾—ç›ŠäºOpenMvå¥½ä¸Šæ‰‹çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å½“åˆé€‰æ‹©OpenMvçš„åŸå› ã€‚å¯ä¹Ÿå¸¦æ¥å¾ˆå¤§å¼Šç«¯ï¼Œå› ä¸ºæˆ‘ä»æ¥æ²¡æœ‰å­¦è¿‡pythonï¼Œåé¢é€»è¾‘éƒ¨åˆ†æ²¡æœ‰äº†å†ç¨‹çš„æ”¯æŒæˆ‘å°±é‡åˆ°å¤§é—®é¢˜äº†ã€‚</p><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/4.png" alt="æœ€åè¿˜åœ¨å†™ä»£ç çš„è€èƒ¡"></p><p>æœ€åè¿˜åœ¨å†™ä»£ç çš„è€èƒ¡ï¼ˆè¯·å¿½ç•¥æˆ‘ä»¬å¾ˆä¹±çš„å®éªŒå®¤ ğŸ˜‚ ï¼‰</p><h5 id="3-é€»è¾‘"><a href="#3-é€»è¾‘" class="headerlink" title="3.é€»è¾‘"></a>3.é€»è¾‘</h5><p>&emsp;&emsp;èµ›é¢˜è¦æ±‚ä¸€å¥—ä»£ç è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œå¯¹æ²¡ä»€ä¹ˆç»éªŒçš„æˆ‘æ¥è¯´ï¼Œè¿™éš¾åº¦æ¯”ä¸Šå¤©è¿˜éš¾ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰OpenMvï¼Œæ‰€ä»¥åªèƒ½åœ¨ä¸Šé¢åˆè·‘å¾ªè¿¹åˆè·‘æ•°å­—è¯†åˆ«ï¼Œé€»è¾‘å°±å¾ˆéš¾å†™ï¼Œè™½ç„¶æˆ‘ä»¬é˜Ÿä¼é‡Œé¢æœ‰ä¸€ä½è®¡ç®—æœºçš„åŒå­¦ï¼Œä»–å­¦è¿‡pythonï¼Œä½†ç”±äºæˆ‘ä»¬éƒ½æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦OpenMvï¼Œåœ¨æœ€åæˆ‘ç†¬äº†ä¸€æ™šä¸Šï¼Œç™½å¤©åˆæˆ˜æ–—äº†æœ€ååå‡ å°æ—¶ä¹‹åï¼Œæˆ‘ä»¬è¿˜æ˜¯å¤±è´¥äº†ã€‚</p><p><img src="/2021/12/13/2021%E7%94%B5%E8%B5%9B%E6%80%BB%E7%BB%93/3.png" alt="æœ€å"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬è¿™æ¬¡çš„å¤±è´¥æ˜¯å¿…ç„¶çš„ã€‚å› ä¸ºå›¢é˜Ÿé‡Œé¢æ²¡æœ‰ä¸€ä¸ªäººæœ‰å­¦è¿‡è¿™äº›çŸ¥è¯†ï¼ŒçŸ¥è¯†å‚¨å¤‡ä¸è¶³æ˜¯ä¸€æ–¹é¢ã€‚è¿˜æœ‰é˜Ÿå‘˜çš„ä»»åŠ¡åˆ†é…ä¹Ÿå‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œç”µèµ›æ˜¯ä¸‰äººä¸€ç»„ï¼Œæˆ‘ä»¬å½“æ—¶çš„åˆ†é…æ˜¯ä¸€ä¸ªäººè´Ÿè´£æ‰“æ‚å’Œå†™è®¾è®¡æŠ¥å‘Šï¼Œå¦å¤–ä¸¤ä¸ªä¸€ä¸ªè´Ÿè´£æ•´ä¸ªé¡¹ç›®çš„åˆ¶ä½œéƒ¨åˆ†ã€‚å› ä¸ºé€‰æ‹©çš„é¢˜ç›®å¯¹æˆ‘ä»¬æ¥è¯´å¤ªéš¾ï¼Œé™¤äº†æˆ‘å­¦ä¹ äº†ç‚¹OpenMvä¹‹å¤–ï¼Œå¦å¤–ä¸¤åé˜Ÿå‘˜æ²¡èƒ½å‚ä¸è¿›æ¥ï¼Œå¯¼è‡´åˆ†å·¥ä¸åˆç†ã€‚</p><p>&emsp;&emsp;ä½†æˆ‘è¿˜æ˜¯è§‰å¾—èƒ½å‚åŠ è¿™æ ·çš„æ¯”èµ›ï¼Œå¾ˆå€¼å¾—ï¼Œæ¯”èµ›çš„è¿‡ç¨‹å¾ˆè¿‡ç˜¾ï¼Œç‰¹åˆ«æ˜¯è§£å†³ä¸€ä¸ªåˆä¸€ä¸ªé—®é¢˜çš„è¿‡ç¨‹ã€‚è¿™è®©æˆ‘æ›´åŠ æœ‰åŠ¨åŠ›å»å­¦ä¹ ï¼Œè¡¥ç¼ºè¡¥å·®ã€‚æ˜å¹´çš„æ¯”èµ›æˆ‘ä»¬è¿˜ä¼šå‚åŠ çš„ï¼</p><h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><p>&emsp;&emsp;â¤ï¸çœŸçš„å¾ˆæ„Ÿè°¢æ¯”èµ›ä¸­å­¦æ ¡å’Œè€å¸ˆä»¬çš„å¸®åŠ©ï¼Œä¹Ÿå¾ˆæ„Ÿè°¢å¥½é˜Ÿå‹ç»™æˆ‘å¸¦é¥­ï¼Œèƒ½è®©æˆ‘é€‰æ‹©å›°éš¾çš„é¢˜ç›®æŒ‘æˆ˜è‡ªå·±ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æŒ«æŠ˜ä¹‹åçš„æˆé•¿&quot;&gt;&lt;a href=&quot;#æŒ«æŠ˜ä¹‹åçš„æˆé•¿&quot; class=&quot;headerlink&quot; title=&quot;æŒ«æŠ˜ä¹‹åçš„æˆé•¿&quot;&gt;&lt;/a&gt;æŒ«æŠ˜ä¹‹åçš„æˆé•¿&lt;/h2&gt;&lt;p&gt;&amp;emsp;&amp;emsp;2021å¹´çš„ç”µèµ›è¿‡å»è¿‘ä¸¤ä¸ªæœˆäº†ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ ç”µèµ›ï¼Œè™½ç„¶æœ€åæ²¡èƒ½å®Œèµ›ï¼ˆæˆ‘å¤ª</summary>
      
    
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://ljweb.xyz/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="OpenMv" scheme="https://ljweb.xyz/tags/OpenMv/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨51å•ç‰‡æœºé©±åŠ¨èœ‚é¸£å™¨æ’­æ”¾éŸ³ä¹</title>
    <link href="https://ljweb.xyz/2021/11/29/%E4%BD%BF%E7%94%A851%E5%8D%95%E7%89%87%E6%9C%BA%E9%A9%B1%E5%8A%A8%E8%9C%82%E9%B8%A3%E5%99%A8%E6%92%AD%E6%94%BE%E9%9F%B3%E4%B9%90/"/>
    <id>https://ljweb.xyz/2021/11/29/%E4%BD%BF%E7%94%A851%E5%8D%95%E7%89%87%E6%9C%BA%E9%A9%B1%E5%8A%A8%E8%9C%82%E9%B8%A3%E5%99%A8%E6%92%AD%E6%94%BE%E9%9F%B3%E4%B9%90/</id>
    <published>2021-11-29T15:49:50.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_37697335/article/details/84915995">https://blog.csdn.net/m0_37697335/article/details/84915995</a></p></blockquote><h3 id="æœ‰æºèœ‚é¸£å™¨ä¸æ— æºèœ‚é¸£å™¨çš„åŒºåˆ«"><a href="#æœ‰æºèœ‚é¸£å™¨ä¸æ— æºèœ‚é¸£å™¨çš„åŒºåˆ«" class="headerlink" title="æœ‰æºèœ‚é¸£å™¨ä¸æ— æºèœ‚é¸£å™¨çš„åŒºåˆ«"></a>æœ‰æºèœ‚é¸£å™¨ä¸æ— æºèœ‚é¸£å™¨çš„åŒºåˆ«</h3><h4 id="æ— æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š"><a href="#æ— æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š" class="headerlink" title="æ— æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š"></a>æ— æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š</h4><p>1ã€ æ— æºå†…éƒ¨ä¸å¸¦éœ‡è¡æºï¼Œæ‰€ä»¥å¦‚æœç”¨ç›´æµä¿¡å·æ— æ³•ä»¤å…¶é¸£å«ã€‚å¿…é¡»ç”¨2K~5Kçš„æ–¹æ³¢ï¼ˆå»ºè®®ä½¿ç”¨PWMï¼‰å»é©±åŠ¨å®ƒ</p><p>2ã€ å£°éŸ³é¢‘ç‡å¯æ§ï¼Œå¯ä»¥åšå‡ºâ€œå¤šæ¥ç±³å‘ç´¢æ‹‰è¥¿â€çš„æ•ˆæœã€‚                                                                                                                    </p><p>3ã€ å¯ä»¥ä½¿å‘ˆç°çš„å‘éŸ³æ•ˆæœæ›´ä¸°å¯Œï¼Œå½“ç„¶æ§åˆ¶æ–¹å¼ä¹Ÿå› æ­¤å˜å¾—æ¯”æœ‰æºèœ‚é¸£å™¨æ›´å¤æ‚ä¸€ç‚¹ã€‚</p><h4 id="æœ‰æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š"><a href="#æœ‰æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š" class="headerlink" title="æœ‰æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š"></a>æœ‰æºèœ‚é¸£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼š</h4><p>1 ã€æœ‰æºèœ‚é¸£å™¨å†…éƒ¨å¸¦éœ‡è¡æºï¼Œæ‰€ä»¥åªè¦ä¸€é€šç”µå°±ä¼šå«<br>2ã€ ç¨‹åºæ§åˆ¶æ–¹ä¾¿ï¼Œå•ç‰‡æœºä¸€ä¸ªé«˜ä½ç”µå¹³å°±å¯ä»¥è®©å…¶å‘å‡ºå£°éŸ³ï¼Œè€Œæ— æºèœ‚é¸£å™¨å´åšä¸åˆ°ã€‚                                                                  </p><p>3ã€ æ•ˆæœå•ä¸€ï¼Œä½†æ˜¯æ§åˆ¶ç®€å•ï¼Œå¦‚æœä»…æ˜¯ä½œä¸ºå•ä¸€æ— å˜åŒ–çš„æç¤ºéŸ³ä½¿ç”¨ï¼Œæœ‰æºèœ‚é¸£å™¨æ— ç–‘æ˜¯ä¸€ç§å¥½é€‰æ‹©ã€‚</p><h3 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RldTmr(fr) 65536 - (11059200 / 12) / (fr &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FuDian(n) (n &lt;&lt; 1) / 3    <span class="comment">//é™„ç‚¹nåˆ†éŸ³ç¬¦çš„æ¢ç®—</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> UCHAR;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> UINT;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> ULONG;</span><br><span class="line"> </span><br><span class="line">sbit BUZZ = P0^<span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">UINT code noteFreq[] = &#123;    <span class="comment">//ä¸­éŸ³ 1-7 å’Œé«˜éŸ³ 1-7å¯¹åº”çš„é¢‘ç‡åˆ—è¡¨</span></span><br><span class="line">    <span class="number">523</span>, <span class="number">587</span>, <span class="number">659</span>, <span class="number">698</span>, <span class="number">784</span>, <span class="number">880</span>, <span class="number">988</span>,</span><br><span class="line">    <span class="number">1047</span>, <span class="number">1175</span>, <span class="number">1319</span>, <span class="number">1397</span>, <span class="number">1568</span>, <span class="number">1760</span>, <span class="number">1976</span></span><br><span class="line">&#125;;</span><br><span class="line">UINT code tmrRld[] = &#123;      <span class="comment">//ä¸­éŸ³ 1-7 å’Œé«˜éŸ³ 1-7å¯¹åº”çš„å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    RldTmr(<span class="number">523</span>), RldTmr(<span class="number">587</span>), RldTmr(<span class="number">659</span>), RldTmr(<span class="number">698</span>), RldTmr(<span class="number">784</span>), RldTmr(<span class="number">880</span>), RldTmr(<span class="number">988</span>),</span><br><span class="line">    RldTmr(<span class="number">1047</span>), RldTmr(<span class="number">1175</span>), RldTmr(<span class="number">1319</span>), RldTmr(<span class="number">1397</span>), RldTmr(<span class="number">1568</span>), RldTmr(<span class="number">1760</span>), RldTmr(<span class="number">1976</span>),</span><br><span class="line">&#125;;</span><br><span class="line">UCHAR code musicNote[] = &#123;      <span class="comment">//éŸ³å</span></span><br><span class="line">    <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line">UCHAR code noteDuration[] = &#123;       <span class="comment">//éŸ³åå¯¹åº”çš„æ—¶å€¼ï¼Œ4è¡¨ç¤º4åˆ†éŸ³ç¬¦ï¼Œ8è¡¨ç¤º8åˆ†éŸ³ç¬¦ï¼Œ16è¡¨ç¤º16åˆ†éŸ³ç¬¦</span></span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>,</span><br><span class="line">    FuDian(<span class="number">8</span>), <span class="number">16</span>, FuDian(<span class="number">8</span>), <span class="number">16</span>, <span class="number">4</span>, <span class="number">4</span>,</span><br><span class="line">    FuDian(<span class="number">8</span>), <span class="number">16</span>, FuDian(<span class="number">8</span>), <span class="number">16</span>, <span class="number">4</span>, <span class="number">4</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line">bit enable = <span class="number">1</span>, tmrFlg = <span class="number">0</span>;</span><br><span class="line">UCHAR T0RH = <span class="number">0XFF</span>, T0RL = <span class="number">0X00</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay</span><span class="params">(UINT n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayMusic</span><span class="params">(UCHAR speed)</span></span>;    <span class="comment">//å›ºå®šæ ‡å‡†ä¸º4åˆ†éŸ³ç¬¦çš„é€Ÿåº¦ï¼šä¾‹å¦‚speed = 108 è¡¨ç¤ºä¸€åˆ†é’Ÿæ‰«è¿‡108ä¸ª4åˆ†éŸ³ç¬¦</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    EA = <span class="number">1</span>;</span><br><span class="line">    TMOD = <span class="number">0X01</span>;</span><br><span class="line">    TH0 = T0RH;</span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    ET0 = <span class="number">1</span>;</span><br><span class="line">    TR0 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        PlayMusic(<span class="number">72</span>);</span><br><span class="line">        Delay(<span class="number">40000u</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay</span><span class="params">(UINT n)</span> </span>&#123;</span><br><span class="line">    UINT i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PlayMusic</span><span class="params">(UCHAR speed)</span> </span>&#123;</span><br><span class="line">    UCHAR i;</span><br><span class="line">    UCHAR idx;</span><br><span class="line">    UINT cnt = <span class="number">0</span>;</span><br><span class="line">    UINT durationCnt = <span class="number">0</span>;<span class="comment">//å½“å‰éŸ³ç¬¦çš„æ—¶å€¼å¯¹åº”çš„å®šæ—¶å™¨è®¡æ•°</span></span><br><span class="line">    UINT soundCnt = <span class="number">0</span>;<span class="comment">//å½“å‰éŸ³ç¬¦çš„å‘å£°æ—¶å€¼å¯¹åº”çš„è®¡æ•°å€¼</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span> (musicNote); ) &#123;</span><br><span class="line">        <span class="keyword">while</span> (!tmrFlg) ;</span><br><span class="line">        tmrFlg = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (cnt == <span class="number">0</span>) &#123;</span><br><span class="line">            idx = musicNote[i] - <span class="number">1</span>;</span><br><span class="line">            T0RH = tmrRld[idx] &gt;&gt; <span class="number">8</span>;</span><br><span class="line">            T0RL = tmrRld[idx];</span><br><span class="line">            durationCnt = (ULONG)<span class="number">240</span> * (ULONG)noteFreq[idx] / ((ULONG)noteDuration[i] * (ULONG)speed);</span><br><span class="line">            soundCnt = durationCnt - (durationCnt &gt;&gt; <span class="number">2</span>);<span class="comment">//å½“å‰éŸ³ç¬¦æ—¶å€¼çš„å‰3/4å‘å£°ï¼Œå1/4é™éŸ³</span></span><br><span class="line">            enable = <span class="number">1</span>;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cnt == durationCnt) &#123;</span><br><span class="line">                cnt = <span class="number">0</span>;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                <span class="keyword">if</span> (cnt == soundCnt) &#123;</span><br><span class="line">                    enable = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InterruptTmr0</span><span class="params">()</span> interrupt 1 </span>&#123;</span><br><span class="line">    TH0 = T0RH;</span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    tmrFlg = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (enable)</span><br><span class="line">        BUZZ = ~BUZZ;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        BUZZ = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/m0_37697335/article/details/84915995&quot;&gt;https://blog.csdn.net/m0_37697335/article/details/84</summary>
      
    
    
    
    <category term="51å•ç‰‡æœº" scheme="https://ljweb.xyz/categories/51%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
    
    <category term="51" scheme="https://ljweb.xyz/tags/51/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰é™å·®åˆ†æ³•å¤„ç†ç”µç£åœºé—®é¢˜</title>
    <link href="https://ljweb.xyz/2021/11/28/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86%E6%B3%95%E5%A4%84%E7%90%86%E7%94%B5%E7%A3%81%E5%9C%BA%E9%97%AE%E9%A2%98/"/>
    <id>https://ljweb.xyz/2021/11/28/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86%E6%B3%95%E5%A4%84%E7%90%86%E7%94%B5%E7%A3%81%E5%9C%BA%E9%97%AE%E9%A2%98/</id>
    <published>2021-11-28T16:00:00.000Z</published>
    <updated>2022-02-16T14:10:43.468Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/11/28/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86%E6%B3%95%E5%A4%84%E7%90%86%E7%94%B5%E7%A3%81%E5%9C%BA%E9%97%AE%E9%A2%98/1.1.jpg" alt="img1.1">  <img src="/2021/11/28/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86%E6%B3%95%E5%A4%84%E7%90%86%E7%94%B5%E7%A3%81%E5%9C%BA%E9%97%AE%E9%A2%98/2.1.jpg" alt="img2.1"></p><h3 id="mag-å‚è€ƒä»£ç ï¼š"><a href="#mag-å‚è€ƒä»£ç ï¼š" class="headerlink" title=":mag: å‚è€ƒä»£ç ï¼š"></a>:mag: å‚è€ƒä»£ç ï¼š</h3><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">clear all</span><br><span class="line">m=<span class="number">22</span>;</span><br><span class="line"><span class="keyword">for</span> k=<span class="number">1</span>:m</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:m</span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">1</span></span><br><span class="line">            V(<span class="built_in">j</span>,k)=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">elseif</span> ((<span class="built_in">j</span>==<span class="number">1</span>)|(<span class="built_in">j</span>==m)|(k==m))</span><br><span class="line">            V(<span class="built_in">j</span>,k)=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            V(<span class="built_in">j</span>,k)=<span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">cha=<span class="number">0.01</span>;</span><br><span class="line">delta=<span class="number">0</span>;</span><br><span class="line">n=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    n=n+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> k=<span class="number">2</span>:m<span class="number">-1</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">2</span>:m<span class="number">-1</span></span><br><span class="line">            Vnew(<span class="built_in">j</span>,k)=<span class="number">0.25</span>*(V(<span class="built_in">j</span>+<span class="number">1</span>,k)+V(<span class="built_in">j</span><span class="number">-1</span>,k)+V(<span class="built_in">j</span>,k+<span class="number">1</span>)+V(<span class="built_in">j</span>,k<span class="number">-1</span>));</span><br><span class="line">            d=<span class="built_in">abs</span>((Vnew(<span class="built_in">j</span>,k)-V(<span class="built_in">j</span>,k))/V(<span class="built_in">j</span>,k));</span><br><span class="line">            <span class="keyword">if</span> d&gt;delta</span><br><span class="line">                delta=d;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            V(<span class="built_in">j</span>,k)=Vnew(<span class="built_in">j</span>,k);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> delta&lt;cha</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> n&gt;<span class="number">100</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    delta=<span class="number">0.</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">k=<span class="number">1</span>:m;</span><br><span class="line"><span class="built_in">j</span>=<span class="number">1</span>:m;</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line">[DX,DY]=gradient(V,<span class="number">.4</span>,<span class="number">.4</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">quiver(k,<span class="built_in">j</span>,DX,DY,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line">xlabel(<span class="string">&#x27;ç”µåœºçº¿å›¾åƒ&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;å§“å&#x27;</span>)</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line">[DX,DY]=gradient(V,<span class="number">.4</span>,<span class="number">.4</span>)</span><br><span class="line">A=(DX.^<span class="number">2</span>+DY.^<span class="number">2</span>).^<span class="number">0.5</span>;</span><br><span class="line">[DA,DB]=gradient(A,<span class="number">.4</span>,<span class="number">.4</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">quiver(k,<span class="built_in">j</span>,DA,DB,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line">xlabel(<span class="string">&#x27;ç”µåŠ›çº¿å›¾åƒ&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;å§“å&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/2021/11/28/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86%E6%B3%95%E5%A4%84%E7%90%86%E7%94%B5%E7%A3%81%E5%9C%BA%E9%97%AE%E9%A2%98/1.1.jp</summary>
      
    
    
    
    
    <category term="å®éªŒ" scheme="https://ljweb.xyz/tags/%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>mini Macintosh plus(åŸºäºESP32)</title>
    <link href="https://ljweb.xyz/2021/11/25/mini-macintosh-plus-%E5%9F%BA%E4%BA%8EESP32/"/>
    <id>https://ljweb.xyz/2021/11/25/mini-macintosh-plus-%E5%9F%BA%E4%BA%8EESP32/</id>
    <published>2021-11-25T12:54:21.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://spritesmods.com/?art=minimacplus">Sprites mods - Miniature Macintosh Plus - Intro</a></p></blockquote><h1 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h1><img src="https://spritesmods.com/minimacplus/mac_teaser.png" alt="img"><p>Back in the early days of computing, there was a company called Apple. They just had great success with their Apple II line of computers, but needed to innovate to stay on top of the quickly-developing computer scene. They already were working on the Lisa line of computers, a minicomputer-inspired beast intended for business users and priced as such, but that was deemed too expensive for the average customer. As a secondary project, the Macintosh was developed, initially with the idea in mind to make a new generation of computer for â€˜the man on the streetâ€™ which should cost about $500. Steve Jobs got put on the project, and under him the hardware got more advanced,the software got a GUI instead of a text interface, and the price ballooned into almost $2500. Although the hardware you got for this price was slightly underwhelming, lacking e.g. the graphics accelerators and hardware sound capabilities other machines had, the software made more than up for it. This first Macintosh was the Mac 128K and its succes spurned more advanced models of this compact Mac, namely the Macintosh 512K, the Macintosh Plus, and the Macintosh SE-series. </p><p>While the development of the Macintosh happened around 1984, way before I was at an age I could understand computers, I do feel some kind of kinship with the compact Macintosh: the first computer my parents owned was a Macintosh Plus. It was later joined by a 20MB SCSI hard disk, and on that machine I wrote my first Basic-programs. Back when I still lived in the Netherlands, I actually bought a broken SE/30 machine and <a href="http://spritesmods.com/?art=macsearm">converted</a> that into a Linux-server while still being able to run Mac-software. I left that machine in the Netherlands, however, and here in Shanghai, I have no classic Apple hardware anymore.</p><p>While obviously I donâ€™t really need a Mac Plus anymore for my day-to-day life, I did like the idea of having one available for when I felt nostalgic. Maybe I could get a tiny bit of the Macintosh experience back by building a small one myself. Seeing I already have some experience with <a href="https://hackaday.com/2016/11/28/tiniest-game-boy-hides-in-your-pocket/">making smaller versions of old hardware</a>, why not try to apply that process to the venerable Mac Plus as well?</p><h1 id="Display"><a href="#Display" class="headerlink" title="Display"></a>Display</h1><p>So, what to use when building something like this? One of the ways that sprung to mind was to take a Raspberry Pi or something, add a 2.5â€ LCD, add an emulator like PCE or MiniVMac, 3d-print an enclosure and call it a day. But I didnâ€™t feel that would do my idea justice: not only would it be too big for my tastes, it also would be too easy: With the original Mac 128K, even while the end result was seen as underpowered, the hardware designers that built it did their best to pull a few nice tricks to save cost. Just assembling off-the-shelf commodity hardware into a replica felt like I would be doing the original design a disservice. So off to Taobao for some more exotic components I went!</p><p><img src="https://spritesmods.com/minimacplus/oled_taobao.png" alt="img"></p><p>I decided to start with the display. The Mac had a fairly high-resolution display for its time, and finding a display to replicate that had a pretty high priority. In general, when it comes to displays available on the Chinese electronic market, thereâ€™s a large choice available. Unfortunately, the â€˜large choiceâ€™ seems to consist of either higher-resolution but larger screens, or alternatively tiny but lower-resolution screens. Ideally, I needed a resolution of 512x342 pixels; that is the native Mac resolution and on a screen like that, I would be able to display everything without rescaling. Unfortunately, screens with this resolution donâ€™t readily exist; the next best resolution up would be something like 640x480. Screens with that resolution, for some reason, tend to start out pretty big: the smallest viable one I could find was about 3.5â€. So unfortunately, I would have to do some downscaling if I wanted to make the Mac as small as possible.</p><p>After deciding it would be okay to downscale a bit, I had access to a fair amount more displays. One of the displays that popped up pretty quickly was the x163qln01, an 1.63â€ OLED screen made by AUO. While slightly expensive (about US$25 per screen), this display has good availability on Taobao and a datasheet that at least documents the pinouts, dimensions and power source requirements. This display seems to be made for certain Android smartwatches, and with some mangling of search terms, Google even spat out some initialization sequences I could use.</p><p>The only problem (well, aside from the connector that had pins a mere 0.5mm apart) was that the display did not use a parallel or SPI interface, but a MIPI interface. Iâ€™d have to tackle that later on.</p><p>With the choice of display made, I could move on to the processor. I grabbed an ESP32-Wrover module for this. This module contains an ESP32 (a WiFi chip with 2 32-bit CPUs running at 240MHz and about half a megabyte of RAM), 4MiB of flash and 4MiB of PSRAM memory. My guess was that the 2 CPU cores would be fast enough to emulate a Mac and that I could use the 4MiB of PSRAM memory to give the Mac its RAM. While 4MiB of flash is not that much, it should be enough for the emulator plus a small-ish hard disk with the system software and some programs. Also, it helps that I work for Espressif, making me pretty familiar with the hardware; what also helped was that I could just grab some modules from work instead of having to buy them and then wait for them to arrive.</p><p>With that, I was mostly set - the OLED still needed some components to be powered so the component count was increased by some LDO and other power supply chips. The Mac also needed sound so I sourced a cheap amplifier chip and speaker, and for power and debugging I pulled a common FT232 module out of a drawer somewhere. All these components are pretty small and allow me to scale down the enclosure, resulting in a model that would be a little bit bigger than 1/6th of a real Mac.</p><h1 id="Driving-the-display"><a href="#Driving-the-display" class="headerlink" title="Driving the display"></a>Driving the display</h1><p>While I had nothing to complain about the resolution, size and brightness of the display, actually getting pixels to it was more problematic. The MIPI interface it has was not supported by the ESP32 silicon so I would have to find another way to interface with it. The MIPI DSI interface is a standard developed by the <a href="https://mipi.org/">MIPI Alliance</a> and not public; as a hobbyist, Iâ€™d have to piece together the details from leaked documents and probing of existing devices. Luckily, a year or two ago <a href="http://www.electricstuff.co.uk/">Mike Harrison</a> reverse engineered the MIPI DSI interface used to control iPod displays (<a href="https://www.youtube.com/watch?v=7TedIzmguP0">1</a>, <a href="https://www.youtube.com/watch?v=IIR1Bw8T_vM">2</a>, <a href="https://www.youtube.com/watch?v=YYadGWR3Xuo">3</a>, <a href="https://www.youtube.com/watch?v=dPzeEw3zVwQ">4</a>, <a href="https://www.youtube.com/watch?v=5gvO8-bGMpI">5</a>, <a href="http://www.electricstuff.co.uk/nanohack.html">website</a>) and also managed to find some copies of the specifications. This made my life a lot easier: it helps to at least know what to send to the display.</p><p>While there is a lot more to it (and you should really watch the above videos if you want to know what), the physical layer of the MIPI protocol is pretty simple to explain. The MIPI protocol uses four wires in total: two data- and two clock-lines. The MIPI protocol has two modes of signalling: Low Power (LP) mode and High Speed (HS) mode.</p><p>â€‹                 <a href="https://spritesmods.com/minimacplus/mipi_signal.png"><img src="https://spritesmods.com/minimacplus/mipi_signal-tmb.png" alt="img"></a></p><p>In Low Power mode, the wires are used separately to transmit some control data structures as well as indicate certain commands that have direct effect on the physical receiver on the other side. The voltage swing in this mode is pretty large compared to the high speed mode: voltages are either around 1.2 volt for a high signal, or around 0 volt for a low signal. Because low speed mode has more signal states, it does things like tell the receiver to enter or exit high speed mode. In the diagram above, the blue lines indicate Low Power communication.</p><p>In High Speed mode, the two clock lines (CLKP/CLKN) as well as the two data lines (DP/DN) work as differential lines, with one line always being the opposite as the other one. The receiver detects the difference between the two lines, and deduces the value being sent from this: a 1 if DP is higher, a 0 if DN is higher. High-speed mode, as the name implies, allows for very quick data transfers with clocks up to 1.5GHz. The trick the standard used to get this done without too much EMC and power use is to use very low voltages in this mode: the voltages on the pairs average to about 200mV, with variations of +/- 100mV per line to indicate the ones and zeroes. In the above diagram, the red bits are done in high-speed mode.</p><p>For the actual data transfer, in high speed mode the interface can essentially be seen as a somewhat weird and differential SPI interface: there is a clock and data path, and every clock tick, the value of the data is clocked into the interface. A change from SPI, apart from the fact that the signals are differential, is that a data bit is clocked in whenever the CLK lines change state, instead of only on e.g raising edges. Another difference is that the start of a transfer is detected not by a /CS line going low, but by in-band signalling: every transmission starts with one unique binary â€˜magic wordâ€™ and the receiver detects this value to decide when a transmission starts.</p><p>In order to interface this with the ESP32, Iâ€™d have to do some level shifting. I wanted to run the ESP32 from a 3.0V power source, so all GPIOs would also be 3.0 or 0 volt. To adapt this to the signal levels of the MIPI interface, I opted for the most cheap solution: just use some resistor divider networks.</p><p>To figure out the resistor values, I effectively made equations for the three voltage output states that interested me (1.1V for Low Power high, 0.07V for High Speed low, 0.33V for High Speed high; voltages chosen to stay in-spec for most situations) and the three input states that should generate them. Using some math, I ended up at some equations. I could theoreticaly work out those equations by hand, but eventually decided to throw them into <a href="https://www.wolframalpha.com/">WolframAlpha</a> which gave me the needed resistor values.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">           3V</span><br><span class="line">G -R1--+   R3</span><br><span class="line">G -R2--+ --+----&gt;</span><br><span class="line">           R4</span><br><span class="line">           GND</span><br><span class="line"></span><br><span class="line">R4*(1.9/R1+1.9/R3)=1.1, </span><br><span class="line">(1/(1/R4+1/R1+1/R2))*(2.93/R3)=0.07, </span><br><span class="line">(1/(1/R4+1/R1))*2.67*(1/R3+1/R2)=0.33, </span><br><span class="line">R2=1000</span><br><span class="line"></span><br><span class="line">R1=280, R2=1K, R3=3K6, R4=150</span><br></pre></td></tr></table></figure><p>At that time, I figured I could also cheat a bit: because the lines are differential in high-speed mode, the display will only look at the difference between the two lines to deduce the data sent. This means that I can save a GPIO by holding one of the lines at a fixed voltage, making the other line higher and lower as needed. To do this, I needed a second type of resistor network:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">           3V</span><br><span class="line">           R3</span><br><span class="line">G -R1--+ --+----&gt;</span><br><span class="line">           R4</span><br><span class="line">           GND</span><br><span class="line"></span><br><span class="line">R4*(1.9/R1+1.9/R3)=1.1,</span><br><span class="line">(1/(1/R4+1/R1))*(2.8/R3)=0.2,</span><br><span class="line">R4=150</span><br><span class="line"></span><br><span class="line">R1=320, R3=1500, R4=150</span><br></pre></td></tr></table></figure><p>Another thing to solve was the clocking scheme. Normal SPI clocks in a bit on a raising edge of the clock line. (Or a falling one, depending on the configuration.) MIPI clocks in a bit on both the raising as well as the falling edge of the clock signal. While the ESP32s hardware SPI unit cannot by itself generate a signal like this, we can convert from one to another by using a simple D-type flipflop with its inverted output connected to its input. Every clock pulse on the input will change the level of the output, exactly as is needed here.</p><h1 id="Schematic"><a href="#Schematic" class="headerlink" title="Schematic"></a>Schematic</h1><p>With the display hardware fixed up, the hardest part of the hardware design was done. Now we only need to add the rest. First up, the power supply. This is pretty simple: I feed the entire design from 5V from an USB-to-serial converter that I also can use as a debugging/programming interface. That voltage is taken to generate the +4.6V, -3.4V and 1.8V the OLED screen needs, as well as the 3.0V to feed the ESP32. The +4.6V and -3.4V are generated by a TPS65631 chip, and a reference schematic for that was included in the datasheet for thr OLED. The other voltages are generated by a pair of simple LDOs.<br><a href="https://spritesmods.com/minimacplus/schematic_oledpsu.png"><img src="https://spritesmods.com/minimacplus/schematic_oledpsu-tmb.png" alt="img"></a></p><p>The Macintosh also had sound. The quality isnâ€™t that good by modern standards (22KHz, 8-bit) but the sounds that various software programs make are by now quite iconic, so I couldnâ€™t forego a speaker here. The ESP32 has a built-in 8-bit DAC, and that is used to render the analog soundwaves that the emulator generates. That then gets put into a NS8002 which is a 2W class-AB audio amplifier housed in a small SOIC8 package. It is cheap, needs very few support components and makes more than enough noise for the tiny Mac to attract attention.<br><a href="https://spritesmods.com/minimacplus/schematic_audio.png"><img src="https://spritesmods.com/minimacplus/schematic_audio-tmb.png" alt="img"></a></p><p>One of the things that made the Macintosh so revolutionary is that it was one of the first commercial computers that came with a mouse. The Macintosh team thought so highly of the mouse that essentially the entire OS is based around mouse-controlled UI elements, and unlike, for example, an IBM PC, it is entirely possible to control the entire Macintosh with only a mouse. Obviously, my tiny Mac should also have such an important peripheral. I still do remember the original ball mouse that came with the early Macintoshes, and I do not quite relish the need to get the gunk off the little rollers every so often; there is a reason optical mice have replaced these mechanical devices entirely. This also has the advantage that parts for these new-fangles optical mice are quite easy to obtain: I did not need to spend much effort at all to locate a source of ADNS9500 gaming mouse sensors plus the corresponding optics, for instance.</p><p>The other nice thing is that an optical mouse sensor is a pretty deeply integrated device: a mouse sensor only needs a few other external components to function, and the schematic reflects this. There are a few capacitors for voltage stabilization, an MOSFET (copied straight from the datasheet) to switch the laser diode, and some other jellybean parts. The mouse sensor communicates using a four-wire SPI signal, and Iâ€™ve re-used one of these wires to also send the mouse button signal over: the MISO pin is pulled down with a fairly strong pulldown when this button is pressed. The value of this pulldown resistor is not enough to stop the mouse sensor from communicating, but it is enough to overcome the pullup-resistor that normally pulls up the line, so when the sensor tristates the MISO line, the ESP32 can detect if the button is pressed.<br><a href="https://spritesmods.com/minimacplus/schematic_mouse.png"><img src="https://spritesmods.com/minimacplus/schematic_mouse-tmb.png" alt="img"></a></p><p>Finally, the OLED screen needs connecting. We already did all the hard work calculating all the resistor values, so the schematic should be more or less self-explanatory. The chip added is a D-type flipflop and is used to halve the clock rate: as mentioned before the MIPI standard needs a new data bit every time the clock polarity inverts, while the ESP32 can only send out a new one on a raising or falling edge.<br><a href="https://spritesmods.com/minimacplus/schematic_oledclkdata.png"><img src="https://spritesmods.com/minimacplus/schematic_oledclkdata-tmb.png" alt="img"></a></p><p>With the schematic drawn, I moved on to the PCB artwork. The display I chose was meant to be mounted to its controlling PCB, with the connector on the backside of that PCB. While that would not leave much room for the other components, I still wanted to put all the other components on the other side.<br><a href="https://spritesmods.com/minimacplus/pcbs_empty.jpg"><img src="https://spritesmods.com/minimacplus/pcbs_empty-tmb.jpg" alt="img"></a></p><p>Itâ€™s a good thing I have a good pair of eyes and a hot-air rework station: this allowed me to use 0603 components which made everything fit cleanly on the limited PCB space. Especially the connector for the display and the QFN OLED power supply chip would be pretty hard to do with a normal soldering iron.</p><p>â€‹                    <a href="https://spritesmods.com/minimacplus/pcb_populated.jpg"><img src="https://spritesmods.com/minimacplus/pcb_populated-tmb.jpg" alt="img"></a></p><p>For the mouse sensor and attached components, I figured out using a PCB would use up too much space. Instead, I opted to solder all components on the sensor itself, freeform style. This way, everything should be able to fit in the mouse.</p><p>â€‹                    <a href="https://spritesmods.com/minimacplus/mousesensor.jpg"><img src="https://spritesmods.com/minimacplus/mousesensor-tmb.jpg" alt="img"></a></p><h1 id="Software"><a href="#Software" class="headerlink" title="Software"></a>Software</h1><p>â€‹                                <a href="https://spritesmods.com/minimacplus/mac_poster.jpg"><img src="https://spritesmods.com/minimacplus/mac_poster-tmb.jpg" alt="img"></a></p><p>Now obviously, the software is a fairly big element of this build: the entire Macintosh needs to be emulated. The Macintosh, however, is not that complicated a machine. It essentially consists of the 68000 microcontroller, a Zilog Z8530 serial communications controller that controls the serial port, a 6522 VIA for some internal input and output and for interfacing with the keyboard and some random PALs containing the logic for the display and sound. There also is an Integrated Woz Machine-chip to interface with the floppy drive. This is a fairly complicated chip; however I was not planning to emulate a floppy so for emulation it would be enough to emulate an IWM that always returns that thereâ€™s no floppy in the drive. Instead, my plan was to fully emulate the NCR 5380 SCSI chip, connected to an emulated SCSI hard disk that would read from the onboard flash of the ESP32-Wrover module.</p><p>Furthermore, there are very few programs that attempt to access this hardware directly: programmers for the Mac were told from the start to use the OS-level hardware abstraction layers in order to stay compatible with later versions of the Mac hardware. In general, this means that when I succeeded emulating the hardware to a standard where the OS boots and stays happy, most programs would also run without complaints.</p><p>Because of this I decided I might as well program the emulator from scratch. Well, not entirely from scratch; the 68000 is a fairly complex beast and I didnâ€™t feel like reinventing <em>that</em> particular wheel. Instead, I looked around on the Internet, and <a href="http://mamedev.org/">MAME</a> had a nice and quick C-based 68K emulator called Musashi that fit the bill nicely. It needed some slight mangling to put the lookup tables for the opcodes into flash instead of RAM, but otherwise it didnâ€™t need much to port to the ESP32.</p><p>However, I wasnâ€™t planning on developing the entire thing on the ESP32: while the chip has OpenOCD support allowing for a fair amount of debugging, the upload/test/fix/upload/â€¦ cycle would get pretty tedious. Instead, I decided to develop the thing on my Linux-machine first, keeping in mind the limits the ESP32 would eventually give me. So I went to work, using the datasheets for the various chips, the <a href="http://www.mac.linux-m68k.org/devel/plushw.php">Linux-68K</a> notes for the machine, as well as bits and pieces of the Inside Macintosh series that were floating around on the Internet. When I couldnâ€™t find out from these what to do, I still had the option to sneak a peek under the hood of <a href="http://www.gryphel.com/c/minivmac/">other</a> <a href="http://www.hampa.ch/pce/pce-macplus.html">open-source</a> <a href="http://www.mess.org/mess/drivers/mac/macplus">emulators</a>.</p><p>Armed with all that, gcc as the C-compiler and libsdl as the library to get graphics going, I set to work. Long story short, some time later I ended up having a basic but mostly functional MacPlus emulator: mouse, video, SCSI hard disk and sound all worked:<br><a href="https://spritesmods.com/minimacplus/tme_booted.png"><img src="https://spritesmods.com/minimacplus/tme_booted-tmb.png" alt="img"></a></p><p>Because my hardware wasnâ€™t done yet, I decided to port my emulator to an ESP-Wrover-Kit devboard. I had access to a few of these boards anyway, and apart from the Wrover module I was going to use anyway, it also had a nice 320x240 display I could use to see if video works.<br><a href="https://spritesmods.com/minimacplus/mac_wroom.jpg"><img src="https://spritesmods.com/minimacplus/mac_wroom-tmb.jpg" alt="img"></a></p><p>After some tweaking, the Mac emulator actually ran fairly well on this board; it usually comes pretty close to the 7.8MHz the Mac Plus normally runs at. (Actually, 7.8MHz would be slightly faster than a Mac Plus; because the frame buffer and sound system in the real thing eat up some of the memory cycles, the actual effective frequency could be as much as 35% lower.)</p><p>Obviously, getting the emulator working on a devboard is a nice step along the way, but in the end, the thing needs to run on the screen that I bought, not the devboard screen. And hold on a second, the devkit screen is 320x240 and cuts off a fair chunk of the Mac screen. The display I intend to use is 320x320 and as such only larger vertically: how am I going to get the 512x342 Mac screen displayed on it?</p><p>Thereâ€™s one way to put 512x342 pixels onto a 320x320 screen, and that is scaling. Effectively, you take an image, then squish it to make it smaller, then you display it. However, scaling can be done in multiple ways and especially with a black-and-white image generated by an OS that assumes every pixel it set results in a clearly distinguishable point of light on the screen, there are multiple ways to do it badly. Effectively, I would like to lose as little resolution as possible. This means I needed to increase the resolution of my OLED.</p><p>But how do you do that? I can hardly open up the OLED screen and squish some more pixels in there. However, I donâ€™t need to; the OLED display already has three times as many pixels as advertised. The reason for this is that the OLED screen is a color one: for each virtual â€˜pixelâ€™, it has a red, a green and a blue subpixel. Additionally, in this specific screen, the subpixels are laid out in triangles. To illustrate this, hereâ€™s a close-up of the screen, with three pixels lit:<br><a href="https://spritesmods.com/minimacplus/pixels.jpg"><img src="https://spritesmods.com/minimacplus/pixels-tmb.jpg" alt="img"></a></p><p>As you can see, the pixels are triangle-shaped sets of three subpixels; depending on the column they are on, the triangles either point up or down. This effectively means that our subpixel screen resolution is a nice 480 x 640 pixels instead. While still not entirely adequate for displaying 512x342 pixels, the difference is so small that with a small bit of well-chosen scaling the display looks as readable as an 1.63â€ display showing a GUI meant for a 9â€ screen will ever be:<br><a href="https://spritesmods.com/minimacplus/disp_scaled.jpg"><img src="https://spritesmods.com/minimacplus/disp_scaled_tmb.jpg" alt="img"></a></p><h1 id="Enclosure"><a href="#Enclosure" class="headerlink" title="Enclosure"></a>Enclosure</h1><p>So now I had a display, software that could emulate a Macintosh Plus fairly well, plus a microcontroller it could run on. Whatâ€™s still missing? A nice box to put it in, obviously!</p><p>I decided to 3d-print one on the nice Formlabs 1+ SLA printer my work has. To do this, I first needed a model. I wanted to build one from scratch. Obviously, to do this it would be best if I had a real Macintosh Plus at my disposal. I actually have one in my posession, but it was half a continent awayâ€¦ Luckily, I could get my hands on the next best thing: some kind soul uploaded the dimensions of an original Mac 128K (which has almost the same case as the Plus) to the <a href="https://www.ifixit.com/Wiki/Macintosh_128K_Dimensions">iFixit</a> wiki.</p><p>I still do all my 3d modeling in OpenScad, and after some sweating and cursing to get all the curves looking like they should, I had a nice model of an 1-to-6-scale Mac. <a href="https://spritesmods.com/minimacplus/scad.jpg"><img src="https://spritesmods.com/minimacplus/scad-tmb.jpg" alt="img"></a></p><p>The mouse was also created from the iFixit images, but because it needed to fit the (relatively large) optical mouse sensor, unfortunately it couldnâ€™t be scaled to 1/6th of the real thing. The scale is more like 2/5th, making it seem somewhat large next to the tiny Mac but also making it way more usable for non-scaled-down human fingers.</p><p><a href="https://spritesmods.com/minimacplus/scad_mouse.png"><img src="https://spritesmods.com/minimacplus/scad_mouse-tmb.png" alt="img"></a></p><p>So now all that remained was to print the thing. I exported the design as various STL files and used the Formlabs 1+ to print them. This went fairly well, althought the resin was somewhat old so I put a few more supports than the default in to make sure I wouldnâ€™t get a mis-print. The end result came out pretty nice; the only regret I have is that I didnâ€™t put locking clips for the two halves in the design. I eventually worked around that by just sealing the two halves together using a drop of superglue.<br><a href="https://spritesmods.com/minimacplus/case_done.jpg"><img src="https://spritesmods.com/minimacplus/case_done_tmb.jpg" alt="img"></a></p><h1 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h1><p>So, I had all the parts and I just needed to click them together. The PCB slots in the front of the case, where a few clips hold it in. The usb-to-serial converter, used as an upload mechanism and a power supply, slot into the back bit and is also held by a few clips. I forgot to make something to hold the speaker in, but some superglue can easily affix it inside the case. Finally, the mouse is connected using a bundle of thin wires. (And yes, they kind-of clash with the color schemeâ€¦ as soon as I find a nicer, thin multi-core cable Iâ€™ll replace it with that.)</p><p><a href="https://spritesmods.com/minimacplus/done.jpg"><img src="https://spritesmods.com/minimacplus/done-tmb.jpg" alt="img"></a></p><p>Now, when designing things on a computer in order to have them materialize in full later on, like what happens when you finally receive those PCBs from the factory or when your 3d-printer finishes printing that design you worked for weeks on, is the scale of the thing. Obviously, I knew that all sizes would be 1/6th of a real Mac, but only when everything was put together and I saw the thing in real life, the implications of this showed. The Mac truly is tiny!<br><a href="https://spritesmods.com/minimacplus/tiny.jpg"><img src="https://spritesmods.com/minimacplus/tiny_tmb.jpg" alt="img"></a> <a href="https://spritesmods.com/minimacplus/mac_full2.jpg"><img src="https://spritesmods.com/minimacplus/mac_full2_tmb.jpg" alt="img"></a></p><p>And even with its minute size and lack of a keyboard, it does run most of the things the Mac is well-known for. Here is a demonstration. The first 20 seconds are the memory test, and I know from experience the test lasting this long is not a bug: it took our original Mac Plus that long to boot as well after we upgraded it.</p><p>So, what good is this Mac Plus in the end? Admittently, while I had a blast making it, without a keyboard it canâ€™t really serve a real purpose. Also, it has no connectivity to speak of: I planned to make it do AppleTalk over WiFi, but I failed because of some weirdnesses I couldnâ€™t emulate right in the serial controller chip of the original Mac. Still, with the project finished in the state it is, I can finally live my lifelong dream to have a Mac on my desk displaying the original After Dark flying toasters:<br><img src="https://spritesmods.com/minimacplus/toaster-optimized.gif" alt="img"></p><p>As always, this project is open-source, and the PCB artwork as well as the case design and the firmware are up on <a href="https://github.com/Spritetm/minimacplus">Github</a>. Everything is licensed under the Beer-Ware license so you can mostly do with it what you want. If you ever use it in something, Iâ€™d really appreciate a [note](<a href="http://spritesmods.com/?art=contact&amp;af=Miniature">http://spritesmods.com/?art=contact&amp;af=Miniature</a> Macintosh Plus), however.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://spritesmods.com/?art=minimacplus&quot;&gt;Sprites mods - Miniature Macintosh Plus - Intro&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</summary>
      
    
    
    
    <category term="æ¬è¿" scheme="https://ljweb.xyz/categories/%E6%90%AC%E8%BF%90/"/>
    
    
    <category term="diy" scheme="https://ljweb.xyz/tags/diy/"/>
    
  </entry>
  
  <entry>
    <title>é”‚ç”µæ± ç”µå‹æµ‹é‡ç”µè·¯è®¾è®¡</title>
    <link href="https://ljweb.xyz/2021/11/24/%E9%94%82%E7%94%B5%E6%B1%A0%E7%94%B5%E5%8E%8B%E6%B5%8B%E9%87%8F%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1/"/>
    <id>https://ljweb.xyz/2021/11/24/%E9%94%82%E7%94%B5%E6%B1%A0%E7%94%B5%E5%8E%8B%E6%B5%8B%E9%87%8F%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1/</id>
    <published>2021-11-24T17:36:05.000Z</published>
    <updated>2022-02-16T14:10:43.468Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š</p><p>&emsp;&emsp;1.<a href="https://oshwhub.com/article/li-dian-chi-dian-ya-ce-liang-dian-lu-she-jin">é”‚ç”µæ± ç”µå‹æµ‹é‡ç”µè·¯è®¾è®¡ - ç«‹åˆ›EDAå¼€æºç¡¬ä»¶å¹³å° (oshwhub.com)</a></p><p>&emsp;&emsp;2.<a href="https://rationmcu.com/elecjc/3831.html">é”‚ç”µæ± ç”µå‹æµ‹é‡ç”µè·¯è®¾è®¡ â€“ ç‘ç”Ÿç½‘ (rationmcu.com)</a></p></blockquote><p>&emsp;&emsp;å…ˆè¡¥å……ä¸€ä¸‹é”‚ç”µæ± çš„åŸºæœ¬çŸ¥è¯†</p><p>&emsp;&emsp; é”‚ç”µæ± åœ¨å……æ»¡ç”µçš„æ—¶å€™ï¼Œæ˜¯4.2Vï¼›åœ¨ç”¨å®Œç”µçš„æ—¶å€™ï¼Œä¸æ˜¯0Vï¼Œè€Œæ˜¯2.7Vå·¦å³ï¼Œæ¯ä¸ªå‚å®¶åˆ¶ä½œçš„é”‚ç”µæ± ï¼Œç•¥æœ‰å·®å¼‚ã€‚é‰´äºé”‚ç”µæ± ææ–™çš„å±€é™æ€§ï¼Œç”µå‹è¶…è¿‡4.2Vï¼Œä¼šå‘ç”Ÿå±é™©ï¼Œæ¯”å¦‚ç‡ƒçƒ§ï¼›ç”µå‹ä½äº2.7Vå·¦å³ï¼Œä¼šé€ æˆæ— æ³•å†æ¬¡å……ç”µï¼Œæ€»ä¹‹â€¦é”‚ç”µæ± ç”µå‹è¿‡é«˜å’Œè¿‡ä½ï¼Œéƒ½ä¼šé€ æˆæ°¸ä¹…æŸåã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„äº§å“åœ¨ä½¿ç”¨é”‚ç”µæ± çš„æ—¶å€™ï¼Œéœ€è¦æ—¶åˆ»ç›‘æµ‹é”‚ç”µæ± ç”µå‹ã€‚</p><p>&emsp;&emsp;å……ç”µçš„æ—¶å€™ï¼Œä¸è¦è¶…è¿‡4.2Vï¼Œè¿™ä¸ªè¦æ±‚ï¼Œéœ€è¦äº§å“ä¸­åŠ å…¥å……ç”µç®¡ç†èŠ¯ç‰‡ï¼Œå……ç”µç®¡ç†èŠ¯ç‰‡ä¼šè‡ªåŠ¨åœ¨4.2Vçš„æ—¶å€™åˆ‡æ–­å……ç”µã€‚æ”¾ç”µçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯äº§å“åœ¨æ­£å¸¸ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸è¦è®©é”‚ç”µæ± ç”µå‹ä½äº2.7Vï¼Œæ¯”å¦‚ï¼Œåœ¨2.7Vçš„æ—¶å€™ï¼Œè‡ªåŠ¨å¼ºåˆ¶å…³æœºã€‚</p><p>&emsp;&emsp;é‚£ä¹ˆï¼Œé”‚ç”µæ± ç”µå‹ç›‘æµ‹ç”µè·¯åº”è¯¥æ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿ</p><p><img src="/2021/11/24/%E9%94%82%E7%94%B5%E6%B1%A0%E7%94%B5%E5%8E%8B%E6%B5%8B%E9%87%8F%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1/image.png" alt="img"></p><p>&emsp;&emsp;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåº”è¯¥æ˜¯åˆå­¦è€…æœ€å…ˆæƒ³åˆ°çš„åŠæ³•ã€‚ä¸è¿‡ï¼Œä»”ç»†åˆ†æåä¼šå‘ç°ï¼Œæœ‰å¤§é—®é¢˜ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>&emsp;&emsp;VBATè¿æ¥åˆ°é”‚ç”µæ± æ­£æï¼Œé€šè¿‡ä¸¤ä¸ªç”µé˜»åˆ†å‹ï¼Œè¿æ¥åˆ°å•ç‰‡æœºçš„ADCå¼•è„šã€‚ADCæµ‹åˆ°çš„ç”µå‹ï¼Œå°±æ˜¯é”‚ç”µæ± ç”µå‹çš„ä¸€åŠã€‚å› ä¸ºé”‚ç”µæ± çš„ç”µå‹èŒƒå›´å¤§æ¦‚åœ¨2.7Våˆ°4.2Vä¹‹é—´ï¼Œæ‰€ä»¥ADCå¼•è„šçš„ç”µå‹ä¼šåœ¨1.35~2.1Vä¹‹é—´ï¼Œä¸ä¼šè¶…è¿‡æ™®é€šå•ç‰‡æœºçš„3.3Vç”µå‹ï¼Œçœ‹èµ·æ¥å¾ˆåˆç†ï¼Œä¸è¿‡ï¼Œå½“äº§å“å¤„äºå…³æœºçŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ä»¥ä¸ºé”‚ç”µæ± å°±ä¸è€—ç”µäº†ï¼Œå…¶å®ï¼Œé€šè¿‡ç”µè·¯å¯ä»¥å‘ç°ï¼Œé”‚ç”µæ± å…¶å®è¿˜åœ¨é€šè¿‡2ä¸ª10kçš„ç”µé˜»è€—ç”µã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¯¥äº§å“æ”¾ç€æ”¾ç€ç”µå°±å‡å°‘äº†ï¼Œè€Œä¸”å½“ç”µæ± ç”µå‹å‡å°‘åˆ°2.7Vä»¥ä¸‹æ—¶ï¼Œå°±å¯èƒ½æ— æ³•å……èµ·ç”µæ¥äº†ã€‚</p><p>&emsp;&emsp; æˆ‘åœ¨å›½å¤–çš„ä¸€æ¬¾äº§å“ä¸Šï¼Œçœ‹åˆ°äº†è¿™æ ·çš„ä¸€ä¸ªç”µè·¯ï¼Œå½“ç„¶ï¼Œå·²ç»æŠŠå®ƒä½¿ç”¨åˆ°æˆ‘çš„äº§å“å½“ä¸­ã€‚</p><p><img src="/2021/11/24/%E9%94%82%E7%94%B5%E6%B1%A0%E7%94%B5%E5%8E%8B%E6%B5%8B%E9%87%8F%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1/image-1.png" alt="img"></p><p>&emsp;&emsp;ä¸Šé¢ç”µè·¯ï¼Œå¾ˆå·§å¦™çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä»£ä»·æ˜¯ç”µè·¯æ¿ä¸Šå¤šäº†1ä¸ªMOSç®¡å’Œ2ä¸ªç”µé˜»ï¼ŒCTRLå¼•è„šæ˜¯å•ç‰‡æœºçš„ä¸€ä¸ªæ™®é€šå¼•è„šï¼Œåœ¨å•ç‰‡æœºæ–­ç”µçš„æ—¶å€™ï¼Œè¦æ±‚æ˜¯é«˜é˜»æ€ï¼Œå¦åˆ™ä¹Ÿä¼šè€—ç”µï¼Â·è¿™é‡ŒåŠ MOSç®¡å¹¶ä¸æ˜¯ç”¨æ¥æ§åˆ¶â€œæ˜¯å¦è¦æµ‹é‡ç”µæ± ç”µå‹â€ï¼Œè€Œæ˜¯ä¸ºäº†åœ¨äº§å“å…³æœºçš„æ—¶å€™ï¼Œä¸è¦è®©é”‚ç”µæ± ç”µæ± çš„ç”µå‹é€šè¿‡ä¸¤ä¸ªåˆ†å‹ç”µé˜»ã€‚</p><p>&emsp;&emsp;æ­¤æ—¶ï¼Œè¿˜æœ‰ä¸ªé—®é¢˜è¦è§£å†³ã€‚</p><p>&emsp;&emsp;äº§å“åœ¨æ­£å¸¸ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå½“ç”µæ± ç”µå‹å°äº3.3Væ—¶ï¼ŒLDOçš„è¾“å‡ºç”µå‹ï¼Œå°±ä¸å†æ˜¯3.3Väº†ï¼Œéšç€ç”µæ± ç”µå‹çš„å‡å°ï¼ŒLDOçš„è¾“å‡ºç”µå‹ä¹Ÿä¼šå‡å°ï¼Œæ­¤æ—¶â€¦</p><p>å¦‚æœä¸€ç›´ä½¿ç”¨3.3Vä½œä¸ºåŸºå‡†æ¥æµ‹é‡ç”µæ± ç”µå‹ï¼Œå°±ä¼šå‡ºç°é”™è¯¯ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨æœ‰åŸºå‡†ç”µå‹å¼•è„šçš„å•ç‰‡æœºï¼Œæˆ–è€…æœ‰â€œå†…éƒ¨å‚è€ƒç”µå‹â€+â€œå†…éƒ¨æµ‹é‡é€šé“â€åŠŸèƒ½çš„å•ç‰‡æœº</p><p>ç”¨åŸºå‡†ç”µå‹å¼•è„šè®¡ç®—ç”µæ± ç”µå‹ï¼Œè¿™ä¸ªå¤§å®¶éƒ½æ¸…æ¥šï¼Œæˆ‘é‡ç‚¹è¯´ä¸€ä¸‹â€œå†…éƒ¨å‚è€ƒç”µå‹â€+â€œå†…éƒ¨æµ‹é‡é€šé“â€è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>&emsp;&emsp;ç®€å•æ¥è¯´ï¼Œæœ‰äº†â€œå†…éƒ¨å‚è€ƒç”µå‹â€+â€œå†…éƒ¨æµ‹é‡é€šé“â€ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡å†…éƒ¨æµ‹é‡é€šé“å¾—åˆ°ç²¾ç¡®çš„VDDç”µå‹ï¼Œè€Œä¸å¿…ä½¿ç”¨åŸºå‡†ç”µå‹èŠ¯ç‰‡äº†ï¼Œæ¯•ç«Ÿï¼ŒåŸºå‡†ç”µå‹èŠ¯ç‰‡ä¹ŸæŒºè´µçš„ï¼Œè¿˜å¾—åœ¨ç”µè·¯æ¿ä¸Šå ä¸ªåœ°æ–¹ï¼Œä»¥åŠå¤šå‡ åˆ†é’±çš„ç„Šæ¥è´¹ç”¨ã€‚</p><p>&emsp;&emsp;ä¸‹é¢ï¼Œæˆ‘ä»¬ä»¥STC8Gç³»åˆ—å•ç‰‡æœºä¸ºä¾‹æ¥è¯´ä¸€ä¸‹ã€‚</p><p>&emsp;&emsp;STC8Gçš„ADCç¬¬15é€šé“ï¼Œç”¨æ¥æµ‹é‡å†…éƒ¨å‚è€ƒç”µå‹æºï¼Œå†…éƒ¨å‚è€ƒç”µå‹ä¸º1.19Vï¼Œé€šè¿‡æµ‹é‡å®ƒçš„å€¼ï¼Œåæ¨å‡ºVDDå€¼ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> VDDA; <span class="comment">// VDDAçš„ç”µå‹å€¼ å•ä½æ¯«ä¼</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *BGV; <span class="comment">// å†…éƒ¨å‚è€ƒç”µå‹å€¼ å•ä½æ¯«ä¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ADCåˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ADC_Init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  BGV = (<span class="keyword">int</span> idata *)<span class="number">0xEF</span>;</span><br><span class="line">  ADCCFG = <span class="number">0X2F</span>; <span class="comment">// è®¾ç½®ADCæ—¶é’Ÿ = 24000000/2/16/512 = 1465Hz è½¬æ¢ç»“æœå³å¯¹é½</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">ADCRead</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> res;</span><br><span class="line"></span><br><span class="line">  ADC_CONTR |= <span class="number">0X40</span>; <span class="comment">// å¯åŠ¨ADè½¬æ¢</span></span><br><span class="line">  _nop_();</span><br><span class="line">  _nop_();</span><br><span class="line">  <span class="keyword">while</span>(!(ADC_CONTR&amp;<span class="number">0X20</span>)); <span class="comment">// æŸ¥è¯¢ADCå®Œæˆæ ‡å¿—</span></span><br><span class="line">  ADC_CONTR &amp;= ~<span class="number">0X20</span>;  <span class="comment">// æ¸…é™¤å®Œæˆæ ‡å¿—</span></span><br><span class="line">  res = (ADC_RES&lt;&lt;<span class="number">8</span>)|ADC_RESL; <span class="comment">//è¯»å–ADCç»“æœ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fetch_VDDA</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> i;</span><br><span class="line"></span><br><span class="line">  ADC_CONTR = <span class="number">0X8F</span>; <span class="comment">// ä½¿èƒ½ADCæ¨¡å— å¹¶é€‰æ‹©ç¬¬15é€šé“</span></span><br><span class="line">  ADCRead();</span><br><span class="line">  ADCRead();</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    res+=ADCRead();</span><br><span class="line">  &#125;</span><br><span class="line">  res&gt;&gt;=<span class="number">3</span>; <span class="comment">// è¯»å–8æ¬¡ å–å¹³å‡å€¼</span></span><br><span class="line">  VDDA = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">1023L</span>**BGV/res); <span class="comment">// å¾—å‡ºçš„ç»“æœå•ä½æ˜¯æ¯«ä¼</span></span><br><span class="line">&#125;ä¸Šé¢ä»£ç ï¼Œè·å¾—äº†çœŸå®çš„VDDAå€¼ï¼Œç„¶åå°±å¯ä»¥è®¡ç®—å‡ºçœŸå®çš„ç”µæ± ç”µå‹ã€‚</span><br></pre></td></tr></table></figure><p>æœ¬æ–‡æ‘˜è‡ªç‘ç”Ÿç½‘ï¼Œ<a href="https://rationmcu.com/elecjc/3831.html">ç‚¹å‡»æŸ¥çœ‹åŸé“¾æ¥</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;1.&lt;a href=&quot;https://oshwhub.com/article/li-dian-chi-dian-ya-ce-liang-dian-lu-she-jin&quot;&gt;é”‚ç”µæ± ç”µå‹æµ‹é‡ç”µè·¯è®¾è®¡ - ç«‹åˆ›</summary>
      
    
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://ljweb.xyz/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>å¤§åŠŸç‡ç›´æµæœ‰åˆ·ç”µæœºé©±åŠ¨è®¾è®¡</title>
    <link href="https://ljweb.xyz/2021/11/24/%E5%A4%A7%E5%8A%9F%E7%8E%87%E7%9B%B4%E6%B5%81%E6%9C%89%E5%88%B7%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"/>
    <id>https://ljweb.xyz/2021/11/24/%E5%A4%A7%E5%8A%9F%E7%8E%87%E7%9B%B4%E6%B5%81%E6%9C%89%E5%88%B7%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/</id>
    <published>2021-11-24T17:09:04.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š</p><p>&emsp;&emsp;1.<a href="https://blog.csdn.net/qq_42059060/article/details/103498076">IR2104é©±åŠ¨åŸç†_ChenYXçš„åšå®¢-CSDNåšå®¢</a></p><p>&emsp;&emsp;2.<a href="https://oshwhub.com/JHO_o/4833n-mos-zhi-liu-dian-ji-qu-dong-ban">4833Nï¼ŒMOSï¼Œ ç›´æµç”µæœºé©±åŠ¨æ¿ - ç«‹åˆ›EDAå¼€æºç¡¬ä»¶å¹³å° (oshwhub.com)</a></p><p>&emsp;&emsp;3.<a href="https://oshwhub.com/skqinghuan/BTN8982shuang-lu-da-dian-liu-dia">BTN8982åŒè·¯å¤§ç”µæµç”µæœºé©±åŠ¨ - ç«‹åˆ›EDAå¼€æºç¡¬ä»¶å¹³å° (oshwhub.com)</a></p><p>&emsp;&emsp;4.<a href="https://oshwhub.com/ni-hao-ke-ji/h-qiao-dian-ji-qu-dong_v1-0_copy">å¤§ç”µæµåŒè·¯ç›´æµç”µæœºé©±åŠ¨ Hæ¡¥ MOSç®¡ ã€ä½åˆ›ã€‘ ã€é«˜æ€§ä»·æ¯”ã€‘ - ç«‹åˆ›EDAå¼€æºç¡¬ä»¶å¹³å° (oshwhub.com)</a></p><p>&emsp;&emsp;5.<a href="https://oshwhub.com/STM32EDA/BTN7971Bmu-kuai-_da-gong-shuai-H">BTN7971Bæ¨¡å—_å¤§åŠŸç‡Hæ¡¥é©±åŠ¨å™¨ - ç«‹åˆ›EDAå¼€æºç¡¬ä»¶å¹³å° (oshwhub.com)</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;1.&lt;a href=&quot;https://blog.csdn.net/qq_42059060/article/details/103498076&quot;&gt;IR2104é©±åŠ¨åŸç†_ChenYXçš„åšå®¢-CSDNåšå®¢&lt;/</summary>
      
    
    
    
    <category term="æ™ºèƒ½è½¦" scheme="https://ljweb.xyz/categories/%E6%99%BA%E8%83%BD%E8%BD%A6/"/>
    
    
    <category term="ç”µè·¯" scheme="https://ljweb.xyz/tags/%E7%94%B5%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>linuxå­¦ä¹ ç¬”è®°</title>
    <link href="https://ljweb.xyz/2021/11/24/linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://ljweb.xyz/2021/11/24/linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-11-24T16:00:10.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_23329167/article/details/83856430"> Linuxå¸¸ç”¨å‘½ä»¤_Demonçš„åšå®¢-CSDNåšå®¢_linuxå¸¸ç”¨å‘½ä»¤</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/qq_23329167/article/details/83856430&quot;&gt; Linuxå¸¸ç”¨å‘½ä»¤_Demonçš„åšå®¢-CSDNåšå®¢_linuxå¸¸ç”¨å‘½ä»¤&lt;/a&gt;&lt;/p&gt;
&lt;/block</summary>
      
    
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://ljweb.xyz/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>gitå­¦ä¹ ç¬”è®°</title>
    <link href="https://ljweb.xyz/2021/11/22/git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://ljweb.xyz/2021/11/22/git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-11-22T17:37:08.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://fushaolei.github.io/post/git-note/">Gitå­¦ä¹ ç¬”è®° (fushaolei.github.io)</a></p></blockquote><h3 id="ğŸ¤³å¸¸ç”¨æŒ‡ä»¤"><a href="#ğŸ¤³å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="ğŸ¤³å¸¸ç”¨æŒ‡ä»¤"></a>ğŸ¤³å¸¸ç”¨æŒ‡ä»¤</h3><p><a href="https://fushaolei.github.io/post/git-note/">Gitå­¦ä¹ ç¬”è®° (fushaolei.github.io)</a></p><table><thead><tr><th align="left">æŒ‡ä»¤</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><code>git init</code></td><td align="left">åˆå§‹åŒ–</td></tr><tr><td align="left"><code>git add .</code></td><td align="left">å°†ä¿®æ”¹æ”¾å…¥æš‚å­˜åŒº</td></tr><tr><td align="left"><code>git status</code></td><td align="left">æŸ¥çœ‹çŠ¶æ€</td></tr><tr><td align="left"><code>git log</code></td><td align="left">å¯ä»¥æŸ¥çœ‹æœ‰å‡ ä¸ªç‰ˆæœ¬æäº¤åˆ°ä»“åº“é‡Œ</td></tr><tr><td align="left"><code>git reset --hard ç‰ˆæœ¬å·</code></td><td align="left">ç‰ˆæœ¬å›é€€ï¼Œhardå¼ºåˆ¶å›é€€ï¼Œsoftçš„è¯ä¼šä¿ç•™ä¿®æ”¹</td></tr><tr><td align="left"><code>git stash</code></td><td align="left">å°†ä¿®æ”¹ä¿å­˜èµ·æ¥</td></tr><tr><td align="left"><code>git stash save &quot;xxx&quot;</code></td><td align="left">å°†ä¿®æ”¹ä¿å­˜èµ·æ¥ï¼Œå¹¶è®¾ç½®è¿™ä¸ªä¿å­˜çš„æ ‡ç­¾</td></tr><tr><td align="left"><code>git stash apply stash@&#123;x&#125;</code></td><td align="left">å°†ä¿®æ”¹ç§»å‡ºæ¥</td></tr><tr><td align="left"><code>git branch -vv</code></td><td align="left">æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯æ˜¯å¦ä¸è¿œç«¯åˆ†æ”¯å»ºç«‹äº†è¿æ¥</td></tr><tr><td align="left"><code>git push origin &lt;åˆ†æ”¯å&gt;:&lt;åˆ†æ”¯å&gt;</code></td><td align="left">ä»…ä»…å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°è¿œç«¯åˆ†æ”¯ï¼Œ <strong>æ³¨æ„:è¿™ä¸ªæ“ä½œåªæ˜¯å•çº¯çš„æŠŠæœ¬åœ°çš„åˆ†æ”¯æ¨é€åˆ°è¿œç«¯,å°šæœªå»ºç«‹è¿æ¥</strong></td></tr><tr><td align="left"><code>git remote</code></td><td align="left">æŸ¥çœ‹è¿œç¨‹åº“çš„ä¿¡æ¯ï¼Œç”¨<code>git remote -v</code>å¯ä»¥çœ‹åˆ°æ›´è¯¦ç»†çš„ä¿¡æ¯</td></tr><tr><td align="left"><code>git pull --rebase origin master</code></td><td align="left">å’Œè¿œç¨‹ä»“åº“è¿›è¡Œä¸€ä¸ªåŒæ­¥</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://fushaolei.github.io/post/git-note/&quot;&gt;Gitå­¦ä¹ ç¬”è®° (fushaolei.github.io)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ğŸ¤³å¸¸ç”¨æŒ‡ä»¤&quot;&gt;</summary>
      
    
    
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://ljweb.xyz/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="git" scheme="https://ljweb.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨GitHubActionå®ç°hexoåœ¨çº¿å†™ä½œ</title>
    <link href="https://ljweb.xyz/2021/11/22/%E4%BD%BF%E7%94%A8GitHubAction%E5%AE%9E%E7%8E%B0hexo%E5%9C%A8%E7%BA%BF%E5%86%99%E4%BD%9C/"/>
    <id>https://ljweb.xyz/2021/11/22/%E4%BD%BF%E7%94%A8GitHubAction%E5%AE%9E%E7%8E%B0hexo%E5%9C%A8%E7%BA%BF%E5%86%99%E4%BD%9C/</id>
    <published>2021-11-22T16:56:51.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_41426117/article/details/108703295?ops_request_misc=%7B%22request_id%22:%22163759195116780271594253%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=163759195116780271594253&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-108703295.pc_search_mgc_flag&utm_term=hexo%E5%9C%A8%E7%BA%BF%E7%BC%96%E8%BE%91&spm=1018.2226.3001.4187">GitHub Action + Hexoå®ç°åœ¨çº¿å†™ä½œ_ç£Šå°‘1999çš„åšå®¢-CSDNåšå®¢</a></p></blockquote><p>&emsp;&emsp;å»ºä¸€ä¸ªæ–°çš„ä»“åº“ç»™hexoæ”¾æºæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨GitHub Actionï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># workflow name</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Hexo</span> <span class="string">Blog</span> <span class="string">CI</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># master branch on push, auto run</span></span><br><span class="line"><span class="attr">on:</span> </span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">      </span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span> </span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span> </span><br><span class="line">        </span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="comment"># check it to your workflow can access it</span></span><br><span class="line">    <span class="comment"># from: https://github.com/actions/checkout</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">Repository</span> <span class="string">master</span> <span class="string">branch</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/checkout@master</span> </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># from: https://github.com/actions/setup-node  </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node.js</span> <span class="number">12.</span><span class="string">x</span> </span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-node@master</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">node-version:</span> <span class="string">&quot;12.x&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Hexo</span> <span class="string">Dependencies</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        npm install hexo-cli -g</span></span><br><span class="line"><span class="string">        npm install</span></span><br><span class="line"><span class="string"></span>    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Deploy</span> <span class="string">Private</span> <span class="string">Key</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">        <span class="attr">HEXO_DEPLOY_PRIVATE_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_DEPLOY_PRIVATE_KEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        mkdir -p ~/.ssh/</span></span><br><span class="line"><span class="string">        echo &quot;$HEXO_DEPLOY_PRIVATE_KEY&quot; &gt; ~/.ssh/id_rsa </span></span><br><span class="line"><span class="string">        chmod 600 ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">        ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span></span><br><span class="line"><span class="string"></span>        </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Git</span> <span class="string">Infomation</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">| </span></span><br><span class="line"><span class="string">        git config --global user.name &#x27;&lt;ä½ çš„ç”¨æˆ·å&gt;&#x27; </span></span><br><span class="line"><span class="string">        git config --global user.email &#x27;&lt;ä½ ç™»å½•çš„email&gt;&#x27;</span></span><br><span class="line"><span class="string"></span>    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">Hexo</span> </span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        hexo clean</span></span><br><span class="line"><span class="string">        hexo generate </span></span><br><span class="line"><span class="string">        hexo deploy</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/qq_41426117/article/details/108703295?ops_request_misc=%7B%22request_id%22:%22163759195116</summary>
      
    
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="git" scheme="https://ljweb.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>hexoé¦–è¡Œç¼©è¿›ä¸æ˜¾ç¤ºè§£å†³æ–¹æ³•</title>
    <link href="https://ljweb.xyz/2021/11/21/hexo%E9%A6%96%E8%A1%8C%E7%BC%A9%E8%BF%9B%E4%B8%8D%E6%98%BE%E7%A4%BA%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>https://ljweb.xyz/2021/11/21/hexo%E9%A6%96%E8%A1%8C%E7%BC%A9%E8%BF%9B%E4%B8%8D%E6%98%BE%E7%A4%BA%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</id>
    <published>2021-11-21T13:57:20.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>&emsp;&emsp;é€šè¿‡Markdownå†™çš„æ–‡ç« è½¬æ¢æˆHTMLåé¦–è¡Œæ²¡æœ‰ç¼©è¿›2æ ¼ï¼Œå³ä½¿åœ¨Typoraä¸­æ˜¾ç¤ºæœ‰ç¼©è¿›ï¼ˆè‡ªå·±å¤šæ•²äº†å‡ ä¸ªç©ºæ ¼æˆ–è€…Tapé”®ï¼‰ï¼Œè¿™ç§åŸå› æ˜¯Markdownå¯¹ä¸­æ–‡çš„æ”¯æŒä¸å…¨å¯¼è‡´çš„ã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/Reign_Man/article/details/112096540"> Markdowné¦–è¡Œç¼©è¿›è§£å†³æ–¹æ³•å®ä¾‹_DC-CSDNåšå®¢</a></p></blockquote><p>è§£å†³æ–¹æ³•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”¨ &amp;emsp; ä»£æ›¿ç©ºæ ¼</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;é€šè¿‡Markdownå†™çš„æ–‡ç« è½¬æ¢æˆHTMLåé¦–è¡Œæ²¡æœ‰ç¼©è¿›2æ ¼ï¼Œå³ä½¿åœ¨Typoraä¸­æ˜¾ç¤ºæœ‰ç¼©è¿›ï¼ˆè‡ªå·±å¤šæ•²äº†å‡ ä¸ªç©ºæ ¼æˆ–è€…Tapé”®ï¼‰ï¼Œè¿™ç§åŸå› æ˜¯Markdownå¯¹ä¸­æ–‡çš„æ”¯æŒä¸å…¨å¯¼è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;htt</summary>
      
    
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="typora" scheme="https://ljweb.xyz/tags/typora/"/>
    
  </entry>
  
  <entry>
    <title>ç«‹åˆ›è®­ç»ƒè¥esp32æ•°ç ç®¡æ—¶é’Ÿ</title>
    <link href="https://ljweb.xyz/2021/11/21/%E7%AB%8B%E5%88%9B%E8%AE%AD%E7%BB%83%E8%90%A5esp32%E6%95%B0%E7%A0%81%E7%AE%A1%E6%97%B6%E9%92%9F/"/>
    <id>https://ljweb.xyz/2021/11/21/%E7%AB%8B%E5%88%9B%E8%AE%AD%E7%BB%83%E8%90%A5esp32%E6%95%B0%E7%A0%81%E7%AE%A1%E6%97%B6%E9%92%9F/</id>
    <published>2021-11-21T09:05:11.000Z</published>
    <updated>2022-02-16T14:10:43.468Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;æœ€è¿‘å‚åŠ äº†å­¦æ ¡å®éªŒå®¤çš„ç«‹åˆ›è®­ç»ƒè¥é¡¹ç›®ï¼Œé¡¹ç›®æ˜¯åšä¸€ä¸ªç‰©è”ç½‘çš„æ—¶é’Ÿï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨çš„æ˜¯ESP32-C3æ¨¡ç»„ï¼Œä¸¤ä¸ªå››ä½æ•°ç ç®¡æ¥æ˜¾ç¤ºæ—¶é—´ï¼ŒMAX7219é©±åŠ¨æ•°ç ç®¡ï¼ŒDS1302æ—¶é’ŸèŠ¯ç‰‡æä¾›æ—¶é—´ï¼Œç„¶åè¿˜æœ‰äº”ä¸ªæŒ‰é”®ã€‚ä¸€ä¸ªç¨‹åºä¸‹è½½æŒ‰é”®ï¼Œä¸€ä¸ªRSTæŒ‰é”®ï¼Œè¿˜æœ‰ä¸‰ä¸ªåŠŸèƒ½æŒ‰é”®ã€‚</p><p><img src="https://image.lceda.cn/pullimage/rr0wkYCOCrZKXoptxBP4ylRRHaOQrjIbqBlGyswz.jpeg" alt="img"></p><p>&emsp;&emsp;ç¡¬ä»¶ä¸Šæ¥è¯´è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚æˆ‘åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ äº†é”‚ç”µæ± å……æ”¾ç”µç®¡ç†ï¼Œä½¿ç”¨çš„æ˜¯TP4054è¿™é¢—å……ç”µICå¤–å›´ç”µè·¯éå¸¸å°‘ï¼Œå› ä¸ºç›®å‰æˆ‘è¿˜ä¸ä¼šå…¶ä»–çš„å……ç”µç”µè·¯ï¼Œå°±åªèƒ½å…ˆç”¨è¿™ä¸ªäº†ï¼Œè¿™é¢—èŠ¯ç‰‡å¸¦ä¸€ä¸ªå……ç”µæŒ‡ç¤ºå¼•è„šï¼Œè¿ä¸€é¢—LEDå°±èƒ½æŒ‡ç¤ºå……ç”µäº†ã€‚æˆ‘è¿˜åŠ äº†ä¸ªSHT30æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼Œç„¶åæŠŠDS1302æ¢æˆäº†PCF8563ï¼Œè¿™é¢—æ—¶é’ŸèŠ¯ç‰‡ä¸å•ç‰‡æœºä½¿ç”¨I2Cé€šä¿¡ï¼Œç¨‹åºè®¾è®¡ä¸Šè¦ç¨å¾®å¤æ‚äº›ï¼ŒSHT30ä¹Ÿæ˜¯ç”¨ I2C é€šä¿¡çš„ï¼Œ I2C ç¡®å®æ¯”è¾ƒç¥å¥‡ï¼Œæˆ‘å¤ç”¨äº†ä¸¤ä¸ªå¼•è„šæ¥è¿æ¥è¿™ä¸¤é¢—èŠ¯ç‰‡ã€‚    </p><img src="https://image.lceda.cn/avatars/2021/10/OUCWNn8QNme06G4Ri2w4R79U3PA1vtl94PF3kFbC.png" alt="img" style="zoom:115%;"><p>&emsp;&emsp;è¿™æ¬¡ä½¿ç”¨ç«‹åˆ›EDAè¿›è¡Œç”µè·¯ã€PCBè®¾è®¡ï¼š<a href="https://oshwhub.com/admin3075/ji-yuesp32-di-wu-lian-wang-shi-zhong">é¡¹ç›®å¼€æºé“¾æ¥</a></p><p>&emsp;&emsp;è½¯ä»¶ä¸Šæœ¬æ¥æ‰“ç®—ç”¨ESP-IDFçš„ï¼Œå¯æ˜¯é…ç½®èµ·æ¥éº»çƒ¦çš„å¾ˆï¼Œæ‰€ä»¥æœ€åæˆ‘è¿˜æ˜¯ç”¨æˆ‘ç›®å‰æ¯”è¾ƒç†Ÿæ‚‰çš„arduinoæ¥å®ç°çš„ã€‚æ‰“ç®—ä»¥åæœ‰æ—¶é—´å†æ¥ç”¨ESP-IDFã€‚ </p><h2 id="1-arduinoå‚è€ƒä»£ç "><a href="#1-arduinoå‚è€ƒä»£ç " class="headerlink" title="1.arduinoå‚è€ƒä»£ç "></a>1.arduinoå‚è€ƒä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WiFi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;NTPClient.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Ds1302.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* ssid     = <span class="string">&quot;ssid&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* password = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> CLK = <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> CS = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">int</span> DIN = <span class="number">4</span>; <span class="comment">//è¿™é‡Œå®šä¹‰äº†é‚£ä¸‰ä¸ªè„š</span></span><br><span class="line"><span class="keyword">int</span> sw1=<span class="number">18</span>;<span class="comment">//æ‹¨è½®æŒ‰é”®</span></span><br><span class="line"><span class="keyword">int</span> sw2=<span class="number">19</span>;</span><br><span class="line"><span class="keyword">int</span> sw3=<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sec;</span><br><span class="line"> <span class="keyword">int</span> n=<span class="number">10</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> battery 0</span></span><br><span class="line">WiFiUDP ntpUDP; </span><br><span class="line"><span class="function">NTPClient <span class="title">timeClient</span><span class="params">(ntpUDP, <span class="string">&quot;ntp1.aliyun.com&quot;</span>, <span class="number">60</span>*<span class="number">60</span>*<span class="number">8</span>, <span class="number">30</span>*<span class="number">60</span>*<span class="number">1000</span>)</span></span>;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">smgdispaly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(sec!=timeClient.getSeconds())&#123;</span><br><span class="line">  <span class="keyword">int</span> h1,h2,m1,m2,s1,s2;</span><br><span class="line">  h1=timeClient.getHours()/<span class="number">10</span>;</span><br><span class="line">  h2=timeClient.getHours()%<span class="number">10</span>;</span><br><span class="line">  m1=timeClient.getMinutes()/<span class="number">10</span>;</span><br><span class="line">  m2=timeClient.getMinutes()%<span class="number">10</span>;</span><br><span class="line">  s1=timeClient.getSeconds()/<span class="number">10</span>;</span><br><span class="line">  s2=timeClient.getSeconds()%<span class="number">10</span>;</span><br><span class="line">   Write_Max7219(<span class="number">0x0f</span>, <span class="number">0x00</span>);       <span class="comment">//æ˜¾ç¤ºæµ‹è¯•ï¼š1ï¼›æµ‹è¯•ç»“æŸï¼Œæ­£å¸¸æ˜¾ç¤ºï¼š0</span></span><br><span class="line">   Write_Max7219(<span class="number">1</span>,h1);</span><br><span class="line">   Write_Max7219(<span class="number">2</span>,h2);</span><br><span class="line">   Write_Max7219(<span class="number">4</span>,m1); </span><br><span class="line">   Write_Max7219(<span class="number">5</span>,m2);</span><br><span class="line">   Write_Max7219(<span class="number">7</span>,s1);</span><br><span class="line">   Write_Max7219(<span class="number">8</span>,s2);</span><br><span class="line">   sec=timeClient.getSeconds();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">batterydisplay</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> analog_value = <span class="number">0</span>;</span><br><span class="line">     analog_value = analogRead(battery);</span><br><span class="line">     delay(<span class="number">1000</span>);</span><br><span class="line">     Serial.<span class="built_in">printf</span>(<span class="string">&quot;Current Reading on Pin(%d)=%f\n&quot;</span>,battery,analog_value*<span class="number">4.2</span>/<span class="number">2910</span>);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">switchkey</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(digitalRead(sw2)==LOW)&#123;</span><br><span class="line">    delay(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span>(digitalRead(sw2)==LOW)&#123;</span><br><span class="line">      Serial.println(n);</span><br><span class="line">      Write_Max7219(<span class="number">0x09</span>, <span class="number">0xff</span>); </span><br><span class="line">      Write_Max7219(<span class="number">0x0a</span>, n++);</span><br><span class="line">       <span class="keyword">if</span>(n&gt;=<span class="number">15</span>) n=<span class="number">15</span>;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(digitalRead(sw3)==LOW)&#123;</span><br><span class="line">      delay(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span>(digitalRead(sw3)==LOW)&#123;</span><br><span class="line">          Serial.println(n);</span><br><span class="line">          Write_Max7219(<span class="number">0x09</span>, <span class="number">0xff</span>); </span><br><span class="line">          Write_Max7219(<span class="number">0x0a</span>, n--);</span><br><span class="line">          <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) n=<span class="number">0</span>;          </span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;  <span class="comment">// put your setup code here, to run once:</span></span><br><span class="line">  Serial.begin(<span class="number">115200</span>);</span><br><span class="line">  pinMode(CLK,OUTPUT);</span><br><span class="line">  pinMode(CS,OUTPUT);</span><br><span class="line">  pinMode(DIN,OUTPUT); <span class="comment">//è®©ä¸‰ä¸ªè„šéƒ½æ˜¯è¾“å‡ºçŠ¶æ€</span></span><br><span class="line">  </span><br><span class="line">  pinMode(battery,INPUT);</span><br><span class="line">  </span><br><span class="line">  pinMode(sw1,INPUT_PULLUP);</span><br><span class="line">  pinMode(sw2,INPUT_PULLUP);</span><br><span class="line">  pinMode(sw3,INPUT_PULLUP);</span><br><span class="line">  </span><br><span class="line">  Init_MAX7219();</span><br><span class="line">  WiFi.begin(ssid, password);</span><br><span class="line">    <span class="keyword">while</span> (WiFi.status() != WL_CONNECTED) &#123;</span><br><span class="line">        delay(<span class="number">500</span>);</span><br><span class="line">        Serial.print(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  Serial.println(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  Serial.println(<span class="string">&quot;WiFi connected&quot;</span>);</span><br><span class="line">  Serial.println(<span class="string">&quot;IP address: &quot;</span>);</span><br><span class="line">  Serial.println(WiFi.localIP());</span><br><span class="line">  timeClient.begin();</span><br><span class="line">  sec=timeClient.getSeconds();</span><br><span class="line">   Serial.println(timeClient.getFormattedTime());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// put your main code here, to run repeatedly:</span></span><br><span class="line">   timeClient.update();</span><br><span class="line">   smgdispaly();</span><br><span class="line">   switchkey();</span><br><span class="line">    delay(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delay_xms</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i,j;</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;x;i++)</span><br><span class="line">  <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">112</span>;j++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//--------------------------------------------</span></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå‘MAX7219å†™å…¥å­—èŠ‚</span></span><br><span class="line"><span class="comment">//å…¥å£å‚æ•°ï¼šDATA </span></span><br><span class="line"><span class="comment">//å‡ºå£å‚æ•°ï¼šæ— </span></span><br><span class="line"><span class="comment">//è¯´æ˜ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Write_Max7219_byte</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> DATA)</span>         </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> i;    </span><br><span class="line">    digitalWrite(CS,LOW);                </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">8</span>;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">    &#123;                  </span><br><span class="line">      digitalWrite(CLK,LOW);    </span><br><span class="line">      <span class="keyword">if</span>(DATA&amp;<span class="number">0X80</span>)</span><br><span class="line">           digitalWrite(DIN,HIGH);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">           digitalWrite(DIN,LOW);</span><br><span class="line">      DATA&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">      digitalWrite(CLK,HIGH);</span><br><span class="line">     &#125;                                 </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//-------------------------------------------</span></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå‘MAX7219å†™å…¥æ•°æ®</span></span><br><span class="line"><span class="comment">//å…¥å£å‚æ•°ï¼šaddressã€dat</span></span><br><span class="line"><span class="comment">//å‡ºå£å‚æ•°ï¼šæ— </span></span><br><span class="line"><span class="comment">//è¯´æ˜ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Write_Max7219</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> address,<span class="keyword">unsigned</span> <span class="keyword">char</span> dat)</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">   digitalWrite(CS,LOW);</span><br><span class="line">   Write_Max7219_byte(address);           <span class="comment">//å†™å…¥åœ°å€ï¼Œå³æ•°ç ç®¡ç¼–å·</span></span><br><span class="line">   Write_Max7219_byte(dat);               <span class="comment">//å†™å…¥æ•°æ®ï¼Œå³æ•°ç ç®¡æ˜¾ç¤ºæ•°å­— </span></span><br><span class="line">   digitalWrite(CS,HIGH);                        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_MAX7219</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   Write_Max7219(<span class="number">0x09</span>, <span class="number">0xff</span>);       <span class="comment">//è¯‘ç æ–¹å¼ï¼šBCDç </span></span><br><span class="line">   Write_Max7219(<span class="number">0x0a</span>, <span class="number">15</span>);       <span class="comment">//äº®åº¦</span></span><br><span class="line">   Write_Max7219(<span class="number">0x0b</span>, <span class="number">0x07</span>);       <span class="comment">//æ‰«æç•Œé™ï¼›4ä¸ªæ•°ç ç®¡æ˜¾ç¤º</span></span><br><span class="line">   Write_Max7219(<span class="number">0x0c</span>, <span class="number">0x01</span>);       <span class="comment">//æ‰ç”µæ¨¡å¼ï¼š0ï¼Œæ™®é€šæ¨¡å¼ï¼š1</span></span><br><span class="line">   Write_Max7219(<span class="number">1</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">2</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">3</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">4</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">5</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">6</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">7</span>,<span class="number">0xa</span>);</span><br><span class="line">   Write_Max7219(<span class="number">8</span>,<span class="number">0xa</span>);</span><br><span class="line">   delay(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-ESP-IDFæ­£åœ¨å°è¯•ä¸­â€¦â€¦"><a href="#2-ESP-IDFæ­£åœ¨å°è¯•ä¸­â€¦â€¦" class="headerlink" title="2.ESP-IDFæ­£åœ¨å°è¯•ä¸­â€¦â€¦"></a>2.ESP-IDFæ­£åœ¨å°è¯•ä¸­â€¦â€¦</h2><blockquote><p>å‚è€ƒï¼š<a href="https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32/get-started/index.html">å¿«é€Ÿå…¥é—¨ - ESP32 - â€” ESP-IDF ç¼–ç¨‹æŒ‡å— latest æ–‡æ¡£ (espressif.com)</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&amp;emsp;&amp;emsp;æœ€è¿‘å‚åŠ äº†å­¦æ ¡å®éªŒå®¤çš„ç«‹åˆ›è®­ç»ƒè¥é¡¹ç›®ï¼Œé¡¹ç›®æ˜¯åšä¸€ä¸ªç‰©è”ç½‘çš„æ—¶é’Ÿï¼Œè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨çš„æ˜¯ESP32-C3æ¨¡ç»„ï¼Œä¸¤ä¸ªå››ä½æ•°ç ç®¡æ¥æ˜¾ç¤ºæ—¶é—´ï¼ŒMAX7219é©±åŠ¨æ•°ç ç®¡ï¼ŒDS1302æ—¶é’ŸèŠ¯ç‰‡æä¾›æ—¶é—´ï¼Œç„¶åè¿˜æœ‰äº”ä¸ªæŒ‰é”®ã€‚ä¸€ä¸ªç¨‹åºä¸‹è½½æŒ‰é”®ï¼Œä¸€ä¸ªRSTæŒ‰é”®</summary>
      
    
    
    
    <category term="arduino" scheme="https://ljweb.xyz/categories/arduino/"/>
    
    
    <category term="diy" scheme="https://ljweb.xyz/tags/diy/"/>
    
    <category term="arduino" scheme="https://ljweb.xyz/tags/arduino/"/>
    
    <category term="Cè¯­è¨€" scheme="https://ljweb.xyz/tags/C%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>OpenMv+arduino_unoå®ç°å¾ªè¿¹</title>
    <link href="https://ljweb.xyz/2021/11/21/OpenMv-arduino-uno%E5%AE%9E%E7%8E%B0%E5%BE%AA%E8%BF%B9/"/>
    <id>https://ljweb.xyz/2021/11/21/OpenMv-arduino-uno%E5%AE%9E%E7%8E%B0%E5%BE%AA%E8%BF%B9/</id>
    <published>2021-11-21T08:36:55.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OpenMvï¼š"><a href="#OpenMvï¼š" class="headerlink" title="OpenMvï¼š"></a>OpenMvï¼š</h1><blockquote><p>å‚è€ƒï¼š<a href="https://book.openmv.cc/project/follow-lines.html">å·¡çº¿å°è½¦ Â· OpenMVä¸­æ–‡å…¥é—¨æ•™ç¨‹</a></p></blockquote><h3 id="1-OpenMv-main-py"><a href="#1-OpenMv-main-py" class="headerlink" title="1.OpenMv(main.py)"></a>1.OpenMv(main.py)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">åŠŸèƒ½æè¿°</span></span><br><span class="line"><span class="string">    å®Œæ•´åŠŸèƒ½åŒ…æ‹¬ï¼š</span></span><br><span class="line"><span class="string">    * ç›´çº¿å·¡çº¿</span></span><br><span class="line"><span class="string">    * ç›´è§’è½¬å¼¯åˆ¤å®šã€€(å·¦è½¬orå³è½¬)</span></span><br><span class="line"><span class="string">    * Tå­—å½¢è·¯å£åˆ¤å®š</span></span><br><span class="line"><span class="string">    * åå­—å½¢è·¯å£åˆ¤å®š</span></span><br><span class="line"><span class="string">    å…¶ä¸­ï¼´å­—å½¢è·Ÿåå­—å½¢å¯ä»¥ç”¨ä½œå››è½´æ‚¬åœçš„å‚è€ƒç‚¹ã€‚</span></span><br><span class="line"><span class="string">åŸç†ä»‹ç»</span></span><br><span class="line"><span class="string">    ç®—æ³•çš„ä¸»è¦æ ¸å¿ƒåœ¨äºï¼Œè®²æ•´ä¸ªç”»é¢åˆ†å‰²å‡ºæ¥5ä¸ªROIåŒºåŸŸ</span></span><br><span class="line"><span class="string">    * ä¸Šæ–¹æ¨ªå‘é‡‡æ ·</span></span><br><span class="line"><span class="string">    * ä¸­é—´æ¨ªå‘é‡‡æ ·</span></span><br><span class="line"><span class="string">    * ä¸‹æ–¹æ¨ªå‘é‡‡æ ·</span></span><br><span class="line"><span class="string">    * å·¦ä¾§å‚ç›´é‡‡æ ·</span></span><br><span class="line"><span class="string">    * å³ä¾§å‚ç›´é‡‡æ ·</span></span><br><span class="line"><span class="string">    é€šè¿‡åˆ¤æ–­5ä¸ªå›¾ç‰‡çš„ç»„åˆå…³ç³»ç»™å‡ºè·¯å£ç±»å‹çš„åˆ¤æ–­</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> sensor</span><br><span class="line"><span class="keyword">import</span> image</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pyb</span><br><span class="line"><span class="keyword">from</span> pyb <span class="keyword">import</span> Pin, Timer, UART,LED</span><br><span class="line"><span class="keyword">from</span> GeometryFeature <span class="keyword">import</span> GeometryFeature</span><br><span class="line"></span><br><span class="line">LED(<span class="number">4</span>).on()</span><br><span class="line">is_debug = <span class="literal">True</span></span><br><span class="line"><span class="comment">#--------------æ„Ÿå…‰èŠ¯ç‰‡é…ç½®  START -------------------</span></span><br><span class="line"></span><br><span class="line">DISTORTION_FACTOR = <span class="number">1.5</span> <span class="comment"># è®¾å®šç•¸å˜ç³»æ•°</span></span><br><span class="line">IMG_WIDTH  = <span class="number">64</span></span><br><span class="line">IMG_HEIGHT = <span class="number">64</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_sensor</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    åˆå§‹åŒ–æ„Ÿå…‰èŠ¯ç‰‡</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    sensor.reset()</span><br><span class="line">    sensor.set_pixformat(sensor.GRAYSCALE)</span><br><span class="line">    sensor.set_framesize(sensor.B64X64)                  <span class="comment"># åˆ†è¾¨ç‡ä¸ºB64X64</span></span><br><span class="line">    sensor.skip_frames(time=<span class="number">2000</span>)</span><br><span class="line">    sensor.set_auto_gain(<span class="literal">False</span>)                         <span class="comment"># é¢œè‰²è¿½è¸ªå…³é—­è‡ªåŠ¨å¢ç›Š</span></span><br><span class="line">    sensor.set_auto_whitebal(<span class="literal">False</span>)                     <span class="comment"># é¢œè‰²è¿½è¸ªå…³é—­ç™½å¹³è¡¡</span></span><br><span class="line"></span><br><span class="line">init_sensor()</span><br><span class="line"><span class="comment">#--------------æ„Ÿå…‰èŠ¯ç‰‡é…ç½®  END -------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ternleft</span>():</span></span><br><span class="line">    uart.write(<span class="string">&#x27;G&#x27;</span>)</span><br><span class="line">    time.sleep_ms(<span class="number">650</span>)</span><br><span class="line">    uart.write(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    time.sleep_ms(<span class="number">600</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ternright</span>():</span></span><br><span class="line">    uart.write(<span class="string">&#x27;G&#x27;</span>)</span><br><span class="line">    time.sleep_ms(<span class="number">650</span>)</span><br><span class="line">    uart.write(<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    time.sleep_ms(<span class="number">590</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------ä¸²å£UARTéƒ¨åˆ†  START -------------------</span></span><br><span class="line">uart = pyb.UART(<span class="number">3</span>,<span class="number">115200</span>,timeout_char = <span class="number">1000</span>) <span class="comment">#ä¸²å£åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_symbol</span>(<span class="params">num</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    æ ¹æ®æ•°å€¼æ­£è´Ÿï¼Œè¿”å›æ•°å€¼å¯¹åº”çš„ç¬¦å·</span></span><br><span class="line"><span class="string">    æ­£æ•°ï¼šâ€˜+â€™ï¼Œ è´Ÿæ•°â€˜-â€™ ä¸»è¦ä¸ºäº†æ–¹ä¾¿Cè¯­è¨€è§£æå¾…ç¬¦å·çš„æ•°å€¼ã€‚</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> num &gt;=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;+&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_format_wrapper</span>(<span class="params">yaw_angle, sum_x, sum_y, cx_mean, cx, cy, is_left_angle, is_t, last_y</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    æ ¹æ®é€šä¿¡åè®®å°è£…æ•°æ®</span></span><br><span class="line"><span class="string">    TODO é‡æ–°ç¼–å†™é€šä¿¡åè®®  ä¸é…å¥—Cè§£æä»£ç </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    yaw_angle,sum_x, sum_y æ²¡æœ‰ç”¨åˆ°</span></span><br><span class="line"><span class="string">    cx_mean: roi 1 2 3 å¯¹åº”çš„bolbä¸­å¿ƒçš„xåæ ‡åŠ æƒå¹³å‡ï¼Œ å¦‚æœæ²¡æœ‰å°±è¡¥32  éƒ½æ²¡æœ‰å°±èµ‹å€¼ä¸ºåŸæ¥çš„å€¼</span></span><br><span class="line"><span class="string">    cx : roi 1 3 blob ä¸­å¿ƒåæ ‡çš„åŠ æƒå¹³å‡ï¼Œ å¦‚æœä¸€æ–¹ä¸¢å¤±ï¼Œ å°±èµ‹å€¼ä¸ºå¦å¤–ä¸€ä¸ª  éƒ½æ²¡æœ‰å°±èµ‹å€¼ä¸ºåŸæ¥çš„å€¼</span></span><br><span class="line"><span class="string">    cy : roi 4 5 blob ä¸­å¿ƒåæ ‡çš„åŠ æƒå¹³å‡ï¼Œå¦‚æœä¸€æ–¹ä¸¢å¤±ï¼Œ å°±èµ‹å€¼ä¸ºå¦å¤–ä¸€ä¸ªï¼Œ éƒ½æ²¡æœ‰å°±èµ‹å€¼ä¸ºåŸæ¥çš„å€¼</span></span><br><span class="line"><span class="string">    is_left_angle :ä»£è¡¨æ˜¯å¦æœ‰ç›´è§’ï¼Œï¼ï¼ï¼ä¿¡æ¯ä¸¢å¤±</span></span><br><span class="line"><span class="string">             å…¶å®ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºï¼Œæ˜¯å·¦è½¬è¿˜æ˜¯å³è½¬ T(Tå­—å½¢)  L(Left) R(Right)</span></span><br><span class="line"><span class="string">    last_x, last_y æ˜¯ä¸¤ä¸ªç›´çº¿çš„äº¤å‰ç‚¹çš„åæ ‡  æ”¹å†™ä¸º intersect_xï¼Œintersect_y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    args = [</span></span><br><span class="line"><span class="string">        get_symbol(yaw_angle), # åèˆªè§’ç¬¦å·</span></span><br><span class="line"><span class="string">        abs(int(yaw_angle)), # åèˆªè§’</span></span><br><span class="line"><span class="string">        get_symbol(sum_x), # å…‰æµæ•°æ®sux_xçš„ç¬¦å·</span></span><br><span class="line"><span class="string">        abs(int(sum_x)), # å…‰æµæ•°æ®sum_x</span></span><br><span class="line"><span class="string">        get_symbol(sum_y), # å…‰æµæ•°æ®sum_yçš„ç¬¦å·</span></span><br><span class="line"><span class="string">        abs(int(sum_y)), # å…‰æµæ•°æ® sum_y</span></span><br><span class="line"><span class="string">        int(cx_mean), # xçš„ä¸­å¿ƒï¼Œä¸‰ä¸ªå–æ ·åŒºåŸŸè‰²å—ä¸­å¿ƒxåæ ‡çš„å¹³å‡å€¼</span></span><br><span class="line"><span class="string">        int(cx),</span></span><br><span class="line"><span class="string">        int(cy),</span></span><br><span class="line"><span class="string">        int(is_left_angle),</span></span><br><span class="line"><span class="string">        int(last_x),</span></span><br><span class="line"><span class="string">        int(last_y)</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">    # å°†æ•°å€¼åˆ—è¡¨æŒ‰ç…§é€šä¿¡åè®®ï¼Œè½¬æ¢ä¸ºå¾…å‘é€çš„å­—ç¬¦</span></span><br><span class="line"><span class="string">    info = &#x27;s%c%.2d%c%.2d%c%.2d%.2d%.2d%.2d%.2d%.2d%.2d#&#x27;%tuple(args)</span></span><br><span class="line"><span class="string">    global is_debug</span></span><br><span class="line"><span class="string">    if is_debug:</span></span><br><span class="line"><span class="string">        print(&#x27;s%c%.2d%c%.2d%c%.2d | cx_mean=%.2d cx=%.2d cy=%.2d Turn Left: %.2d | %.2d%.2d#&#x27;%tuple(args))</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cx_mean &gt;= <span class="number">22</span> <span class="keyword">and</span> cx_mean &lt;=<span class="number">40</span> :</span><br><span class="line">        info=<span class="string">&#x27;G&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> cx_mean&lt;<span class="number">22</span>  :</span><br><span class="line">        info=<span class="string">&#x27;L&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> cx_mean&gt;<span class="number">40</span>  :</span><br><span class="line">        info=<span class="string">&#x27;R&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> is_t        :</span><br><span class="line">        info=<span class="string">&#x27;S&#x27;</span></span><br><span class="line">        ternleft()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> info</span><br><span class="line"><span class="comment">#--------------ä¸²å£UARTéƒ¨åˆ† END -------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------å®šæ—¶å™¨éƒ¨åˆ† START -------------------</span></span><br><span class="line"></span><br><span class="line">is_need_send_data = <span class="literal">False</span> <span class="comment"># æ˜¯å¦éœ€è¦å‘é€æ•°æ®çš„ä¿¡å·æ ‡å¿—</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uart_time_trigger</span>(<span class="params">timer</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ä¸²å£å‘é€æ•°æ®çš„å®šæ—¶å™¨ï¼Œå®šæ—¶å™¨çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">global</span> is_need_send_data</span><br><span class="line">    is_need_send_data = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å®šæ—¶å™¨ é¢‘ç‡ä¸º20HZ æ¯ç§’æ‰§è¡Œ20æ¬¡</span></span><br><span class="line">tim = Timer(<span class="number">4</span>, freq=<span class="number">20</span>)</span><br><span class="line"><span class="comment"># è®¾å®šå®šæ—¶å™¨çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">tim.callback(uart_time_trigger)</span><br><span class="line"><span class="comment">#--------------å®šæ—¶å™¨éƒ¨åˆ† END -------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------ç›´çº¿ä¸ç›´è§’æ£€æµ‹éƒ¨åˆ† START -------------------</span></span><br><span class="line"></span><br><span class="line">INTERSERCT_ANGLE_THRESHOLD = (<span class="number">45</span>,<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›´çº¿ç°åº¦å›¾é¢œè‰²é˜ˆå€¼</span></span><br><span class="line">LINE_COLOR_THRESHOLD = [(<span class="number">20</span>, <span class="number">80</span>)]</span><br><span class="line"><span class="comment"># å¦‚æœç›´çº¿æ˜¯ç™½è‰²çš„ï¼Œé˜ˆå€¼ä¿®æ”¹ä¸ºï¼š</span></span><br><span class="line"><span class="comment"># LINE_COLOR_THRESHOLD = [(128, 255)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å–æ ·çª—å£</span></span><br><span class="line">ROIS = &#123;</span><br><span class="line">    <span class="string">&#x27;down&#x27;</span>: (<span class="number">0</span>, <span class="number">55</span>, <span class="number">64</span>, <span class="number">8</span>), <span class="comment"># æ¨ªå‘å–æ ·-ä¸‹æ–¹ 1</span></span><br><span class="line">    <span class="string">&#x27;middle&#x27;</span>: (<span class="number">0</span>, <span class="number">28</span>, <span class="number">64</span>, <span class="number">8</span>), <span class="comment"># æ¨ªå‘å–æ ·-ä¸­é—´ 2</span></span><br><span class="line">    <span class="string">&#x27;up&#x27;</span>: (<span class="number">0</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">8</span>), <span class="comment"># æ¨ªå‘å–æ ·-ä¸Šæ–¹ 3</span></span><br><span class="line">    <span class="string">&#x27;left&#x27;</span>: (<span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">64</span>), <span class="comment"># çºµå‘å–æ ·-å·¦ä¾§ 4</span></span><br><span class="line">    <span class="string">&#x27;right&#x27;</span>: (<span class="number">56</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">64</span>) <span class="comment"># çºµå‘å–æ ·-å³ä¾§ 5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blobs_in_rois</span>(<span class="params">img</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    åœ¨ROISä¸­å¯»æ‰¾è‰²å—ï¼Œè·å–ROIä¸­è‰²å—çš„ä¸­å¿ƒåŒºåŸŸä¸æ˜¯å¦æœ‰è‰²å—çš„ä¿¡æ¯</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">global</span> ROIS</span><br><span class="line">    <span class="keyword">global</span> is_debug</span><br><span class="line"></span><br><span class="line">    roi_blobs_result = &#123;&#125;  <span class="comment"># åœ¨å„ä¸ªROIä¸­å¯»æ‰¾è‰²å—çš„ç»“æœè®°å½•</span></span><br><span class="line">    <span class="keyword">for</span> roi_direct <span class="keyword">in</span> ROIS.keys():</span><br><span class="line">        roi_blobs_result[roi_direct] = &#123;</span><br><span class="line">            <span class="string">&#x27;cx&#x27;</span>: -<span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;cy&#x27;</span>: -<span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;blob_flag&#x27;</span>: <span class="literal">False</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> roi_direct, roi <span class="keyword">in</span> ROIS.items():</span><br><span class="line">        blobs=img.find_blobs(LINE_COLOR_THRESHOLD, roi=roi, merge=<span class="literal">True</span>, pixels_area=<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(blobs) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        largest_blob = <span class="built_in">max</span>(blobs, key=<span class="keyword">lambda</span> b: b.pixels())</span><br><span class="line">        x,y,width,height = largest_blob[:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span>(width &gt;=<span class="number">5</span> <span class="keyword">and</span> width &lt;= <span class="number">15</span> <span class="keyword">and</span> height &gt;= <span class="number">5</span> <span class="keyword">and</span> height &lt;= <span class="number">15</span>):</span><br><span class="line">            <span class="comment"># æ ¹æ®è‰²å—çš„å®½åº¦è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        roi_blobs_result[roi_direct][<span class="string">&#x27;cx&#x27;</span>] = largest_blob.cx()</span><br><span class="line">        roi_blobs_result[roi_direct][<span class="string">&#x27;cy&#x27;</span>] = largest_blob.cy()</span><br><span class="line">        roi_blobs_result[roi_direct][<span class="string">&#x27;blob_flag&#x27;</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> is_debug:</span><br><span class="line">            img.draw_rectangle((x,y,width, height), color=(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> roi_blobs_result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">visualize_result</span>(<span class="params">canvas, cx_mean, cx, cy, is_turn_left, is_turn_right, is_t, is_cross</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    å¯è§†åŒ–ç»“æœ</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span>(is_turn_left <span class="keyword">or</span> is_turn_right <span class="keyword">or</span> is_t <span class="keyword">or</span> is_cross):</span><br><span class="line">        mid_x = <span class="built_in">int</span>(canvas.width()/<span class="number">2</span>)</span><br><span class="line">        mid_y = <span class="built_in">int</span>(canvas.height()/<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># ç»˜åˆ¶xçš„å‡å€¼ç‚¹</span></span><br><span class="line">        canvas.draw_circle(<span class="built_in">int</span>(cx_mean), mid_y, <span class="number">5</span>, color=(<span class="number">255</span>))</span><br><span class="line">        <span class="comment"># ç»˜åˆ¶å±å¹•ä¸­å¿ƒç‚¹</span></span><br><span class="line">        canvas.draw_circle(mid_x, mid_y, <span class="number">8</span>, color=(<span class="number">0</span>))</span><br><span class="line">        canvas.draw_line((mid_x, mid_y, <span class="built_in">int</span>(cx_mean), mid_y), color=(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    turn_type = <span class="string">&#x27;N&#x27;</span> <span class="comment"># å•¥è½¬è§’ä¹Ÿä¸æ˜¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_t <span class="keyword">or</span> is_cross:</span><br><span class="line">        <span class="comment"># åå­—å½¢æˆ–è€…Tå½¢</span></span><br><span class="line">        canvas.draw_cross(<span class="built_in">int</span>(cx), <span class="built_in">int</span>(cy), size=<span class="number">10</span>, color=(<span class="number">255</span>))</span><br><span class="line">        canvas.draw_circle(<span class="built_in">int</span>(cx), <span class="built_in">int</span>(cy), <span class="number">5</span>, color=(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_t:</span><br><span class="line">        turn_type = <span class="string">&#x27;T&#x27;</span> <span class="comment"># Tå­—å½¢çŠ¶</span></span><br><span class="line">    <span class="keyword">elif</span> is_cross:</span><br><span class="line">        turn_type = <span class="string">&#x27;C&#x27;</span> <span class="comment"># åå­—å½¢</span></span><br><span class="line">    <span class="keyword">elif</span> is_turn_left:</span><br><span class="line">        turn_type = <span class="string">&#x27;L&#x27;</span> <span class="comment"># å·¦è½¬</span></span><br><span class="line">    <span class="keyword">elif</span> is_turn_right:</span><br><span class="line">        turn_type = <span class="string">&#x27;R&#x27;</span> <span class="comment"># å³è½¬</span></span><br><span class="line"></span><br><span class="line">    canvas.draw_string(<span class="number">0</span>, <span class="number">0</span>, turn_type, color=(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------ç›´çº¿ä¸ç›´è§’æ£€æµ‹éƒ¨åˆ† END -------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------MAIN-----------------------</span></span><br><span class="line">last_cx = <span class="number">0</span></span><br><span class="line">last_cy = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_need_send_data:</span><br><span class="line">        <span class="comment"># ä¸éœ€è¦å‘é€æ•°æ®</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    is_need_send_data = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‹æ‘„å›¾ç‰‡</span></span><br><span class="line">    img = sensor.snapshot()</span><br><span class="line">    <span class="comment"># å»é™¤å›¾åƒç•¸å˜</span></span><br><span class="line">    img.lens_corr(DISTORTION_FACTOR)</span><br><span class="line">    <span class="comment"># åˆ›å»ºç”»å¸ƒ</span></span><br><span class="line">    <span class="comment"># canvas = img.copy()</span></span><br><span class="line">    <span class="comment"># ä¸ºäº†IDEæ˜¾ç¤ºæ–¹ä¾¿ï¼Œç›´æ¥åœ¨ä»£ç ç»“å°¾ ç”¨IMGç»˜åˆ¶</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ³¨æ„ï¼šæ—æ—çš„ä»£ç é‡Œ è®¡ç®—ç›´çº¿ä¹‹é—´çš„äº¤ç‚¹çš„ä»£ç æ²¡æœ‰ç”¨åˆ°</span></span><br><span class="line">    lines = img.find_lines(threshold=<span class="number">1000</span>, theta_margin = <span class="number">50</span>, rho_margin = <span class="number">50</span>)</span><br><span class="line">    <span class="comment"># å¯»æ‰¾ç›¸äº¤çš„ç‚¹ è¦æ±‚æ»¡è¶³è§’åº¦é˜ˆå€¼</span></span><br><span class="line">    intersect_pt = GeometryFeature.find_interserct_lines(lines, angle_threshold=(<span class="number">45</span>,<span class="number">90</span>), window_size=(IMG_WIDTH, IMG_HEIGHT))</span><br><span class="line">    <span class="keyword">if</span> intersect_pt <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># ç›´çº¿ä¸ç›´çº¿ä¹‹é—´çš„å¤¹è§’ä¸æ»¡è¶³é˜ˆå€¼èŒƒå›´</span></span><br><span class="line">        intersect_x = <span class="number">0</span></span><br><span class="line">        intersect_y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        intersect_x, intersect_y = intersect_pt</span><br><span class="line"></span><br><span class="line">    reslut = find_blobs_in_rois(img)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ¤æ–­æ˜¯å¦éœ€è¦å·¦è½¬ä¸å³è½¬</span></span><br><span class="line">    is_turn_left = <span class="literal">False</span></span><br><span class="line">    is_turn_right = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> reslut[<span class="string">&#x27;up&#x27;</span>][<span class="string">&#x27;blob_flag&#x27;</span>] ) <span class="keyword">and</span> reslut[<span class="string">&#x27;down&#x27;</span>][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">        <span class="keyword">if</span> reslut[<span class="string">&#x27;left&#x27;</span>][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">            is_turn_left = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> reslut[<span class="string">&#x27;right&#x27;</span>][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">            is_turn_right = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ¤æ–­æ˜¯å¦ä¸ºTå½¢çš„è½¨é“</span></span><br><span class="line">    is_t = <span class="literal">False</span></span><br><span class="line">    <span class="comment"># åˆ¤æ–­æ˜¯å¦åå­—å½¢è½¨é“</span></span><br><span class="line">    is_cross = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> roi_direct <span class="keyword">in</span> [<span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;down&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;right&#x27;</span>]:</span><br><span class="line">        <span class="keyword">if</span> reslut[roi_direct][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">    is_t = cnt == <span class="number">3</span></span><br><span class="line">    is_cross = cnt == <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># cx_mean ç”¨äºç¡®å®šè§†è§’ä¸­çš„è½¨é“ä¸­å¿ƒ</span></span><br><span class="line">    <span class="comment"># ç”¨äºè¡¨ç¤ºå·¦å³åç§»é‡</span></span><br><span class="line">    cx_mean = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> roi_direct <span class="keyword">in</span> [<span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;down&#x27;</span>, <span class="string">&#x27;middle&#x27;</span>]:</span><br><span class="line">        <span class="keyword">if</span> reslut[roi_direct][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">            cx_mean += reslut[roi_direct][<span class="string">&#x27;cx&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cx_mean += IMG_WIDTH / <span class="number">2</span></span><br><span class="line">    cx_mean /= <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># cx, cy åªæœ‰åœ¨Tå½¢åŒºåŸŸæ£€æµ‹å‡ºæ¥çš„æ—¶å€™æ‰æœ‰ç”¨ï¼Œ</span></span><br><span class="line">    <span class="comment"># ç”¨äºç¡®å®šè½¨é“ä¸­åœ†å½¢çš„å¤§è‡´åŒºåŸŸï¼Œ ç”¨äºå®šç‚¹ï¼Œ æ˜¯è®¡ç®—åœ†å¿ƒçš„ä¸€ç§è¿‘ä¼¼æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    cx = <span class="number">0</span></span><br><span class="line">    cy = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_cross <span class="keyword">or</span> is_t:</span><br><span class="line">        <span class="comment"># åªåœ¨å‡ºç°åå­—å½¢æˆ–è€…Tå­—å½¢æ‰è®¡ç®—åœ†å¿ƒåæ ‡</span></span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> roi_direct <span class="keyword">in</span> [<span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;down&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> reslut[roi_direct][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">                cx += reslut[roi_direct][<span class="string">&#x27;cx&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> cnt == <span class="number">0</span>:</span><br><span class="line">            cx = last_cx</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cx /= cnt</span><br><span class="line"></span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> roi_direct <span class="keyword">in</span> [<span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;right&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> reslut[roi_direct][<span class="string">&#x27;blob_flag&#x27;</span>]:</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">                cy += reslut[roi_direct][<span class="string">&#x27;cy&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> cnt == <span class="number">0</span>:</span><br><span class="line">            cy = last_cy</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cy /= cnt</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸ºäº†å…¼å®¹ä¹‹å‰çš„ç¨‹åºï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ•°æ®é€šä¿¡åè®®å‘é€</span></span><br><span class="line">    <span class="comment"># æ—æ—çš„ä»£ç é‡Œæ²¡æœ‰ç”¨åˆ°çš„å˜é‡å‡è®¾ä¸º 0ï¼Œ ä¸”å·¡çº¿æ¼”ç¤ºå†ç¨‹ä¸­ï¼Œåªç”¨åˆ°äº†å·¦è½¬</span></span><br><span class="line">    <span class="comment"># å‘é€ä¿¡æ¯æ ¼å¼ï¼Œå¯ä»¥è‡ªè¡Œæ”¹é€ , ä¾‹å¦‚ æ·»åŠ  is_turn_left</span></span><br><span class="line">    info = data_format_wrapper(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, cx_mean, cx, cy, is_turn_left, is_t, <span class="number">0</span>)</span><br><span class="line">    uart.write(info)</span><br><span class="line">    <span class="built_in">print</span>(info)</span><br><span class="line"></span><br><span class="line">    last_cx = cx</span><br><span class="line">    last_cy = cy</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_debug:</span><br><span class="line">        visualize_result(img, cx_mean, cx, cy, is_turn_left, is_turn_right, is_t, is_cross)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-car-py"><a href="#2-car-py" class="headerlink" title="2.car.py"></a>2.car.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyb <span class="keyword">import</span> Pin, Timer</span><br><span class="line">inverse_left=<span class="literal">False</span>  <span class="comment">#change it to True to inverse left wheel</span></span><br><span class="line">inverse_right=<span class="literal">False</span> <span class="comment">#change it to True to inverse right wheel</span></span><br><span class="line"></span><br><span class="line">ain1 =  Pin(<span class="string">&#x27;P0&#x27;</span>, Pin.OUT_PP)</span><br><span class="line">ain2 =  Pin(<span class="string">&#x27;P1&#x27;</span>, Pin.OUT_PP)</span><br><span class="line">bin1 =  Pin(<span class="string">&#x27;P2&#x27;</span>, Pin.OUT_PP)</span><br><span class="line">bin2 =  Pin(<span class="string">&#x27;P3&#x27;</span>, Pin.OUT_PP)</span><br><span class="line">ain1.low()</span><br><span class="line">ain2.low()</span><br><span class="line">bin1.low()</span><br><span class="line">bin2.low()</span><br><span class="line"></span><br><span class="line">pwma = Pin(<span class="string">&#x27;P7&#x27;</span>)</span><br><span class="line">pwmb = Pin(<span class="string">&#x27;P8&#x27;</span>)</span><br><span class="line">tim = Timer(<span class="number">4</span>, freq=<span class="number">1000</span>)</span><br><span class="line">ch1 = tim.channel(<span class="number">1</span>, Timer.PWM, pin=pwma)</span><br><span class="line">ch2 = tim.channel(<span class="number">2</span>, Timer.PWM, pin=pwmb)</span><br><span class="line">ch1.pulse_width_percent(<span class="number">0</span>)</span><br><span class="line">ch2.pulse_width_percent(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">left_speed, right_speed</span>):</span></span><br><span class="line">    <span class="keyword">if</span> inverse_left==<span class="literal">True</span>:</span><br><span class="line">        left_speed=(-left_speed)</span><br><span class="line">    <span class="keyword">if</span> inverse_right==<span class="literal">True</span>:</span><br><span class="line">        right_speed=(-right_speed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> left_speed &lt; <span class="number">0</span>:</span><br><span class="line">        ain1.low()</span><br><span class="line">        ain2.high()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ain1.high()</span><br><span class="line">        ain2.low()</span><br><span class="line">    ch1.pulse_width_percent(<span class="built_in">int</span>(<span class="built_in">abs</span>(left_speed)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> right_speed &lt; <span class="number">0</span>:</span><br><span class="line">        bin1.low()</span><br><span class="line">        bin2.high()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bin1.high()</span><br><span class="line">        bin2.low()</span><br><span class="line">    ch2.pulse_width_percent(<span class="built_in">int</span>(<span class="built_in">abs</span>(right_speed)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-pid-py"><a href="#2-pid-py" class="headerlink" title="2.pid.py"></a>2.pid.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyb <span class="keyword">import</span> millis</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi, isnan</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PID</span>:</span></span><br><span class="line">    _kp = _ki = _kd = _integrator = _imax = <span class="number">0</span></span><br><span class="line">    _last_error = _last_derivative = _last_t = <span class="number">0</span></span><br><span class="line">    _RC = <span class="number">1</span>/(<span class="number">2</span> * pi * <span class="number">20</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, p=<span class="number">0</span>, i=<span class="number">0</span>, d=<span class="number">0</span>, imax=<span class="number">0</span></span>):</span></span><br><span class="line">        self._kp = <span class="built_in">float</span>(p)</span><br><span class="line">        self._ki = <span class="built_in">float</span>(i)</span><br><span class="line">        self._kd = <span class="built_in">float</span>(d)</span><br><span class="line">        self._imax = <span class="built_in">abs</span>(imax)</span><br><span class="line">        self._last_derivative = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_pid</span>(<span class="params">self, error, scaler</span>):</span></span><br><span class="line">        tnow = millis()</span><br><span class="line">        dt = tnow - self._last_t</span><br><span class="line">        output = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> self._last_t == <span class="number">0</span> <span class="keyword">or</span> dt &gt; <span class="number">1000</span>:</span><br><span class="line">            dt = <span class="number">0</span></span><br><span class="line">            self.reset_I()</span><br><span class="line">        self._last_t = tnow</span><br><span class="line">        delta_time = <span class="built_in">float</span>(dt) / <span class="built_in">float</span>(<span class="number">1000</span>)</span><br><span class="line">        output += error * self._kp</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(self._kd) &gt; <span class="number">0</span> <span class="keyword">and</span> dt &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> isnan(self._last_derivative):</span><br><span class="line">                derivative = <span class="number">0</span></span><br><span class="line">                self._last_derivative = <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                derivative = (error - self._last_error) / delta_time</span><br><span class="line">            derivative = self._last_derivative + \</span><br><span class="line">                                     ((delta_time / (self._RC + delta_time)) * \</span><br><span class="line">                                        (derivative - self._last_derivative))</span><br><span class="line">            self._last_error = error</span><br><span class="line">            self._last_derivative = derivative</span><br><span class="line">            output += self._kd * derivative</span><br><span class="line">        output *= scaler</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(self._ki) &gt; <span class="number">0</span> <span class="keyword">and</span> dt &gt; <span class="number">0</span>:</span><br><span class="line">            self._integrator += (error * self._ki) * scaler * delta_time</span><br><span class="line">            <span class="keyword">if</span> self._integrator &lt; -self._imax: self._integrator = -self._imax</span><br><span class="line">            <span class="keyword">elif</span> self._integrator &gt; self._imax: self._integrator = self._imax</span><br><span class="line">            output += self._integrator</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_I</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._integrator = <span class="number">0</span></span><br><span class="line">        self._last_derivative = <span class="built_in">float</span>(<span class="string">&#x27;nan&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="arduino"><a href="#arduino" class="headerlink" title="arduino:"></a>arduino:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Wire.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Adafruit_GFX.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Adafruit_SSD1306.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OLED_RESET 4</span></span><br><span class="line"><span class="function">Adafruit_SSD1306 <span class="title">display</span><span class="params">(OLED_RESET)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (SSD1306_LCDHEIGHT != 64)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">error</span>(<span class="meta-string">&quot;Height incorrect, please fix Adafruit_SSD1306.h!&quot;</span>);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LF1 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LF2 11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI1 6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI2 5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HW1 13</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HW2 12</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RED A0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GREEN A1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TZOUTPUT 8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> leftpwm = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">int</span> rightpwm = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">int</span> quyao = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> com;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> continue_time = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, leftpwm);</span><br><span class="line">  analogWrite(LF2, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI1, rightpwm);</span><br><span class="line">  analogWrite(RI2, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">right</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">180</span>);</span><br><span class="line">  analogWrite(LF2, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI2, <span class="number">180</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">left</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(LF2, <span class="number">180</span>);</span><br><span class="line">  analogWrite(RI1, <span class="number">180</span>);</span><br><span class="line">  analogWrite(RI2, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">back</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(LF2, leftpwm);</span><br><span class="line">  analogWrite(RI1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI2, rightpwm);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">carstop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(LF2, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI2, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doudong</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">150</span>);</span><br><span class="line">  analogWrite(LF2, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI1, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI2, <span class="number">150</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">red</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  digitalWrite(RED,LOW);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">green</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  digitalWrite(GREEN,LOW);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">notlight</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  digitalWrite(RED,HIGH);</span><br><span class="line">  digitalWrite(GREEN,HIGH);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">palldown</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  analogWrite(LF1, <span class="number">80</span>);</span><br><span class="line">  analogWrite(LF2, <span class="number">0</span>);</span><br><span class="line">  analogWrite(RI1, <span class="number">85</span>);</span><br><span class="line">  analogWrite(RI2, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// put your setup code here, to run once:</span></span><br><span class="line">  Serial.begin(<span class="number">115200</span>);</span><br><span class="line">  display.begin(SSD1306_SWITCHCAPVCC, <span class="number">0x3C</span>);</span><br><span class="line">  display.clearDisplay();</span><br><span class="line">  display.display();</span><br><span class="line">  <span class="comment">//delay(2000);</span></span><br><span class="line">  pinMode(LF1, OUTPUT);</span><br><span class="line">  pinMode(LF2, OUTPUT);</span><br><span class="line">  pinMode(RI1, OUTPUT);</span><br><span class="line">  pinMode(RI2, OUTPUT);</span><br><span class="line">  pinMode(HW1, INPUT);</span><br><span class="line">  pinMode(HW2, INPUT);</span><br><span class="line">  </span><br><span class="line">  pinMode(RED, OUTPUT);</span><br><span class="line">  pinMode(GREEN, OUTPUT);</span><br><span class="line">  pinMode(TZOUTPUT, OUTPUT);</span><br><span class="line">  digitalWrite(TZOUTPUT,LOW);</span><br><span class="line">  digitalWrite(RED,HIGH);</span><br><span class="line">  digitalWrite(GREEN,HIGH);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">oledisplay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// text display tests</span></span><br><span class="line">  display.clearDisplay();</span><br><span class="line">  display.setTextSize(<span class="number">1</span>);</span><br><span class="line">  display.setTextColor(WHITE);</span><br><span class="line">  display.setCursor(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  display.print(<span class="string">&quot;leftpwm:&quot;</span>);</span><br><span class="line">  display.println(leftpwm);</span><br><span class="line">  display.print(<span class="string">&quot;rightpwm:&quot;</span>);</span><br><span class="line">  display.println(rightpwm);</span><br><span class="line">  display.setTextSize(<span class="number">2</span>);</span><br><span class="line">  display.print(<span class="string">&quot;com:&quot;</span>);</span><br><span class="line">  display.println(com);</span><br><span class="line">  display.display();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cktx</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æŒ‡ä»¤æ¥æ”¶éƒ¨åˆ†</span></span><br><span class="line">  <span class="comment">//è“ç‰™é¥æ§éƒ¨åˆ†</span></span><br><span class="line">  <span class="comment">// è¯»å–ä¸²å£å‘é€çš„ä¿¡æ¯:</span></span><br><span class="line">  <span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">char</span> inChar;</span><br><span class="line">    inChar = Serial.read();</span><br><span class="line">    <span class="keyword">if</span> (com != inChar)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//  bt_rec_flag = 1;</span></span><br><span class="line">      com = inChar;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="comment">//  else    // è°ƒè¯•ç”¨</span></span><br><span class="line">            <span class="comment">//com = &#x27;S&#x27;;</span></span><br><span class="line">    </span><br><span class="line">   </span><br><span class="line">      </span><br><span class="line">      <span class="keyword">switch</span> (com)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;G&#x27;</span>:    go(); Serial.println(<span class="string">&quot;ç›´è¡Œ&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:  left(); Serial.println(<span class="string">&quot;å·¦è½¬&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;R&#x27;</span>:  right(); Serial.println(<span class="string">&quot;å³è½¬&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:  back(); Serial.println(<span class="string">&quot;åé€€&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:  carstop(); Serial.println(<span class="string">&quot;åœè½¦&quot;</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:  red(); Serial.println(<span class="string">&quot;RED&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:  green();Serial.println(<span class="string">&quot;GREEN&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:  notlight();Serial.println(<span class="string">&quot;ç†„ç­&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;H&#x27;</span>:  palldown();Serial.println(<span class="string">&quot;é€Ÿåº¦å‡åŠ&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span> : <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tinzhi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(digitalRead(HW1)==HIGH||digitalRead(HW2)==HIGH)</span><br><span class="line">  &#123;</span><br><span class="line">    digitalWrite(TZOUTPUT,HIGH);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cktx();</span><br><span class="line">  tinzhi();</span><br><span class="line"> <span class="comment">// Serial.println(quyao);</span></span><br><span class="line"> <span class="comment">// doudong();</span></span><br><span class="line">  <span class="comment">//oledisplay();</span></span><br><span class="line">  <span class="comment">//delay(10);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OpenMvï¼š&quot;&gt;&lt;a href=&quot;#OpenMvï¼š&quot; class=&quot;headerlink&quot; title=&quot;OpenMvï¼š&quot;&gt;&lt;/a&gt;OpenMvï¼š&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://book.openmv.cc/pr</summary>
      
    
    
    
    <category term="æ™ºèƒ½è½¦" scheme="https://ljweb.xyz/categories/%E6%99%BA%E8%83%BD%E8%BD%A6/"/>
    
    
    <category term="OpenMv" scheme="https://ljweb.xyz/tags/OpenMv/"/>
    
    <category term="diy" scheme="https://ljweb.xyz/tags/diy/"/>
    
    <category term="arduino" scheme="https://ljweb.xyz/tags/arduino/"/>
    
  </entry>
  
  <entry>
    <title>typoraä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://ljweb.xyz/2021/11/20/typora%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://ljweb.xyz/2021/11/20/typora%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2021-11-20T17:33:07.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/hider/p/11614688.html">Typoraå…¥é—¨ï¼šå…¨ç½‘æœ€å…¨æ•™ç¨‹ - Hider1214 </a></p></blockquote><h1 id="1-Typoraå¿«æ·é”®æ•´åˆ"><a href="#1-Typoraå¿«æ·é”®æ•´åˆ" class="headerlink" title="1.Typoraå¿«æ·é”®æ•´åˆ"></a>1.Typoraå¿«æ·é”®æ•´åˆ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+1  ä¸€é˜¶æ ‡é¢˜    Ctrl+B  å­—ä½“åŠ ç²—</span><br><span class="line">Ctrl+2  äºŒé˜¶æ ‡é¢˜    Ctrl+I  å­—ä½“å€¾æ–œ</span><br><span class="line">Ctrl+3  ä¸‰é˜¶æ ‡é¢˜    Ctrl+U  ä¸‹åˆ’çº¿</span><br><span class="line">Ctrl+4  å››é˜¶æ ‡é¢˜    Ctrl+Home   è¿”å›Typoraé¡¶éƒ¨</span><br><span class="line">Ctrl+5  äº”é˜¶æ ‡é¢˜    Ctrl+End    è¿”å›Typoraåº•éƒ¨</span><br><span class="line">Ctrl+6  å…­é˜¶æ ‡é¢˜    Ctrl+T  åˆ›å»ºè¡¨æ ¼</span><br><span class="line">Ctrl+L  é€‰ä¸­æŸå¥è¯   Ctrl+K  åˆ›å»ºè¶…é“¾æ¥</span><br><span class="line">Ctrl+D  é€‰ä¸­æŸä¸ªå•è¯  Ctrl+F  æœç´¢</span><br><span class="line">Ctrl+E  é€‰ä¸­ç›¸åŒæ ¼å¼çš„æ–‡å­—   Ctrl+H  æœç´¢å¹¶æ›¿æ¢</span><br><span class="line">Alt+Shift+5     åˆ é™¤çº¿ </span><br><span class="line">Ctrl+Shift+I    æ’å…¥å›¾ç‰‡</span><br><span class="line">Ctrl+Shift+M    å…¬å¼å— </span><br><span class="line">Ctrl+Shift+Q    å¼•ç”¨</span><br><span class="line">Ctrl + B        åŠ ç²—</span><br><span class="line">æ³¨ï¼šä¸€äº›å®ä½“ç¬¦å·éœ€è¦åœ¨å®ä½“ç¬¦å·ä¹‹å‰åŠ â€\â€æ‰èƒ½å¤Ÿæ˜¾ç¤º</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://www.cnblogs.com/hider/p/11614688.html&quot;&gt;Typoraå…¥é—¨ï¼šå…¨ç½‘æœ€å…¨æ•™ç¨‹ - Hider1214 &lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-Typo</summary>
      
    
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="æ•™ç¨‹" scheme="https://ljweb.xyz/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="typora" scheme="https://ljweb.xyz/tags/typora/"/>
    
  </entry>
  
  <entry>
    <title>51å¾ªè¿¹å°è½¦</title>
    <link href="https://ljweb.xyz/2021/11/20/51%E5%BE%AA%E8%BF%B9%E5%B0%8F%E8%BD%A6/"/>
    <id>https://ljweb.xyz/2021/11/20/51%E5%BE%AA%E8%BF%B9%E5%B0%8F%E8%BD%A6/</id>
    <published>2021-11-20T16:54:55.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED1=P2^<span class="number">7</span>;<span class="comment">//å¤§ç¯ 0äº®</span></span><br><span class="line">sbit LED2=P2^<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">sbit LF1=P0^<span class="number">2</span>;<span class="comment">//å·¦å‰ç”µæœº</span></span><br><span class="line">sbit LF2=P0^<span class="number">3</span>;</span><br><span class="line">sbit RF1=P0^<span class="number">4</span>;<span class="comment">//å³å‰ç”µæœº</span></span><br><span class="line">sbit RF2=P0^<span class="number">5</span>;</span><br><span class="line">sbit LB2=P0^<span class="number">0</span>;<span class="comment">//å·¦åç”µæœº</span></span><br><span class="line">sbit LB1=P0^<span class="number">1</span>;</span><br><span class="line">sbit RB1=P0^<span class="number">6</span>;<span class="comment">//å³åç”µæœº</span></span><br><span class="line">sbit RB2=P0^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">sbit XJ1  = P2^<span class="number">4</span>;<span class="comment">//å³è¾¹çº¢å¤–ä¼ æ„Ÿå™¨çš„æ•°æ®å£</span></span><br><span class="line">sbit XJ2  = P2^<span class="number">5</span>;<span class="comment">//å·¦è¾¹çº¢å¤–ä¼ æ„Ÿå™¨çš„æ•°æ®å£</span></span><br><span class="line"></span><br><span class="line">sbit BZ1=P2^<span class="number">3</span>;<span class="comment">//å·¦å³é¿éšœä¼ æ„Ÿå™¨æ•°æ®å£</span></span><br><span class="line">sbit BZ2=P2^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> zkb1 = <span class="number">0</span>;<span class="comment">//å®šä¹‰äº†ä¸€ä¸‹å·¦è¾¹ä¸¤ä¸ªè½®çš„å ç©ºæ¯”</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> zkb2 = <span class="number">0</span>;<span class="comment">//å®šä¹‰äº†ä¸€ä¸‹å³è¾¹ä¸¤ä¸ªè½®çš„å ç©ºæ¯”</span></span><br><span class="line"><span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delayms</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> ms)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i=<span class="number">100</span>,j;</span><br><span class="line"><span class="keyword">for</span>(;ms;ms--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(--i)</span><br><span class="line">&#123;</span><br><span class="line">j=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">while</span>(--j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PIT_Init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> EA    = <span class="number">1</span>;</span><br><span class="line">TMOD |= <span class="number">0x01</span>;</span><br><span class="line">TH0   = (<span class="number">65536</span> - <span class="number">200</span>) / <span class="number">256</span>;</span><br><span class="line">TL0   = (<span class="number">65536</span> - <span class="number">200</span>) % <span class="number">256</span>;</span><br><span class="line">ET0   = <span class="number">1</span>;</span><br><span class="line">TR0   = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">timer</span><span class="params">()</span>interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  TH0 = (<span class="number">65536</span><span class="number">-200</span>)/<span class="number">256</span>;</span><br><span class="line">TL0 = (<span class="number">65536</span><span class="number">-200</span>)%<span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(t&lt;zkb1)</span><br><span class="line">&#123;</span><br><span class="line">   LF1=<span class="number">0</span>;</span><br><span class="line">LF2=<span class="number">1</span>;</span><br><span class="line">LB1=<span class="number">0</span>;</span><br><span class="line">LB2=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  LF1=<span class="number">0</span>;</span><br><span class="line">LF2=<span class="number">0</span>;</span><br><span class="line">LB1=<span class="number">0</span>;</span><br><span class="line">LB2=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(t&lt;zkb2)</span><br><span class="line">&#123;</span><br><span class="line">RF1=<span class="number">0</span>;</span><br><span class="line">RF2=<span class="number">1</span>;</span><br><span class="line">RB1=<span class="number">0</span>;</span><br><span class="line">RB2=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  RF1=<span class="number">0</span>;</span><br><span class="line">RF2=<span class="number">0</span>;</span><br><span class="line">RB1=<span class="number">0</span>;</span><br><span class="line">RB2=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t = (t + <span class="number">1</span>) %<span class="number">50</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span><span class="comment">//è·‘ç›´çº¿</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">zkb1=<span class="number">7</span>;</span><br><span class="line">zkb2=<span class="number">7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">right</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">zkb1=<span class="number">12</span>;</span><br><span class="line">zkb2=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">left</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">zkb1=<span class="number">0</span>;</span><br><span class="line">zkb2=<span class="number">12</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">zkb1=<span class="number">0</span>;</span><br><span class="line">zkb2=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delay</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> x,y;</span><br><span class="line">  <span class="keyword">for</span>(x=<span class="number">0</span>;x&lt;k;x++)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">for</span>(y=<span class="number">0</span>;y&lt;<span class="number">200</span>;y++);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">xunji</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> flag;</span><br><span class="line">    <span class="keyword">if</span>((XJ1==<span class="number">1</span>)&amp;&amp;(XJ2==<span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">   flag = <span class="number">0</span>;<span class="comment">//å·¦è¾¹æ£€æµ‹åˆ°é»‘çº¿</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((XJ1==<span class="number">0</span>)&amp;&amp;(XJ2==<span class="number">1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">flag = <span class="number">1</span>;<span class="comment">//å³è¾¹æ£€æµ‹åˆ°é»‘çº¿</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((XJ1==<span class="number">1</span>)&amp;&amp;(XJ2==<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"> flag = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>((BZ1==<span class="number">0</span>)||(BZ2==<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span>(flag)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:  right();delay(<span class="number">5</span>);stop();LED1=<span class="number">1</span>;LED2=<span class="number">0</span>;delay(<span class="number">5</span>);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:  left();delay(<span class="number">5</span>);stop(); LED1=<span class="number">0</span>;LED2=<span class="number">1</span>;delay(<span class="number">5</span>);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:  run();delay(<span class="number">1</span>);stop(); LED1=<span class="number">1</span>;LED2=<span class="number">1</span>; delay(<span class="number">1</span>);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:  run();delay(<span class="number">1</span>);stop(); LED1=<span class="number">1</span>;LED2=<span class="number">1</span>; delay(<span class="number">1</span>);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>: stop();delay(<span class="number">5</span>);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>: run();delay(<span class="number">5</span>);stop(); LED1=<span class="number">1</span>;LED2=<span class="number">1</span>; delay(<span class="number">11</span>);<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">PIT_Init();</span><br><span class="line">LED1=<span class="number">0</span>;</span><br><span class="line">LED2=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">xunji();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‚è€ƒä»£ç &quot;&gt;&lt;a href=&quot;#å‚è€ƒä»£ç &quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒä»£ç &quot;&gt;&lt;/a&gt;å‚è€ƒä»£ç &lt;/h1&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s</summary>
      
    
    
    
    <category term="51å•ç‰‡æœº" scheme="https://ljweb.xyz/categories/51%E5%8D%95%E7%89%87%E6%9C%BA/"/>
    
    
    <category term="diy" scheme="https://ljweb.xyz/tags/diy/"/>
    
    <category term="51" scheme="https://ljweb.xyz/tags/51/"/>
    
  </entry>
  
  <entry>
    <title>11.9å®‰ç§‘æ˜Ÿè½¨</title>
    <link href="https://ljweb.xyz/2021/11/19/%E6%8B%8D%E8%BF%87%E7%9A%84%E4%B8%80%E4%BA%9B%E6%98%9F%E8%BD%A8/"/>
    <id>https://ljweb.xyz/2021/11/19/%E6%8B%8D%E8%BF%87%E7%9A%84%E4%B8%80%E4%BA%9B%E6%98%9F%E8%BD%A8/</id>
    <published>2021-11-19T14:58:26.000Z</published>
    <updated>2022-02-16T14:10:43.424Z</updated>
    
    <content type="html"><![CDATA[<hr><p>æ‹æ‘„æ—¥æœŸï¼š2021å¹´11æœˆ9æ—¥</p><p>è®¾å¤‡ï¼šNIKON Z6</p><p>å‚æ•°ï¼š15s f/5.6 24mm ISO1000</p><p><img src="/2021/11/19/%E6%8B%8D%E8%BF%87%E7%9A%84%E4%B8%80%E4%BA%9B%E6%98%9F%E8%BD%A8/AKXG11.9.jpg" alt="AKXG11.9"></p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;p&gt;æ‹æ‘„æ—¥æœŸï¼š2021å¹´11æœˆ9æ—¥&lt;/p&gt;
&lt;p&gt;è®¾å¤‡ï¼šNIKON Z6&lt;/p&gt;
&lt;p&gt;å‚æ•°ï¼š15s f/5.6 24mm ISO1000&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/11/19/%E6%8B%8D%E8%BF%87%E7%9A%84%E4%B8%8</summary>
      
    
    
    
    
    <category term="æ˜Ÿè½¨" scheme="https://ljweb.xyz/tags/%E6%98%9F%E8%BD%A8/"/>
    
  </entry>
  
  <entry>
    <title>Hello World!</title>
    <link href="https://ljweb.xyz/2021/11/18/HELLO/"/>
    <id>https://ljweb.xyz/2021/11/18/HELLO/</id>
    <published>2021-11-18T19:17:15.000Z</published>
    <updated>2022-02-16T14:10:43.384Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å„ç§è¯­è¨€çš„Hello-World"><a href="#å„ç§è¯­è¨€çš„Hello-World" class="headerlink" title="å„ç§è¯­è¨€çš„Hello World"></a>å„ç§è¯­è¨€çš„Hello World</h1><p>1.Cè¯­è¨€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mian</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å„ç§è¯­è¨€çš„Hello-World&quot;&gt;&lt;a href=&quot;#å„ç§è¯­è¨€çš„Hello-World&quot; class=&quot;headerlink&quot; title=&quot;å„ç§è¯­è¨€çš„Hello World&quot;&gt;&lt;/a&gt;å„ç§è¯­è¨€çš„Hello World&lt;/h1&gt;&lt;p&gt;1.Cè¯­è¨€&lt;/p&gt;
&lt;fig</summary>
      
    
    
    
    
  </entry>
  
</feed>
